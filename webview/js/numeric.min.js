"use strict";var numeric="undefined"==typeof exports?function(){}:exports;"undefined"!=typeof global&&(global.numeric=numeric),numeric.version="1.2.6",numeric.bench=function(r,n){var e,i,t,u;for("undefined"==typeof n&&(n=15),t=.5,e=new Date;;){for(t*=2,u=t;u>3;u-=4)r(),r(),r(),r();for(;u>0;)r(),u--;if(i=new Date,i-e>n)break}for(u=t;u>3;u-=4)r(),r(),r(),r();for(;u>0;)r(),u--;return i=new Date,1e3*(3*t-1)/(i-e)},numeric._myIndexOf=function(r){var e,n=this.length;for(e=0;n>e;++e)if(this[e]===r)return e;return-1},numeric.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:numeric._myIndexOf,numeric.Function=Function,numeric.precision=4,numeric.largeArray=50,numeric.prettyPrint=function(r){function n(r){if(0===r)return"0";if(isNaN(r))return"NaN";if(0>r)return"-"+n(-r);if(isFinite(r)){var e=Math.floor(Math.log(r)/Math.log(10)),i=r/Math.pow(10,e),t=i.toPrecision(numeric.precision);return 10===parseFloat(t)&&(e++,i=1,t=i.toPrecision(numeric.precision)),parseFloat(t).toString()+"e"+e.toString()}return"Infinity"}function e(r){var t;if("undefined"==typeof r)return i.push(Array(numeric.precision+8).join(" ")),!1;if("string"==typeof r)return i.push('"'+r+'"'),!1;if("boolean"==typeof r)return i.push(r.toString()),!1;if("number"==typeof r){var u=n(r),o=r.toPrecision(numeric.precision),c=parseFloat(r.toString()).toString(),a=[u,o,c,parseFloat(o).toString(),parseFloat(c).toString()];for(t=1;t<a.length;t++)a[t].length<u.length&&(u=a[t]);return i.push(Array(numeric.precision+8-u.length).join(" ")+u),!1}if(null===r)return i.push("null"),!1;if("function"==typeof r){i.push(r.toString());var f=!1;for(t in r)r.hasOwnProperty(t)&&(i.push(f?",\n":"\n{"),f=!0,i.push(t),i.push(": \n"),e(r[t]));return f&&i.push("}\n"),!0}if(r instanceof Array){if(r.length>numeric.largeArray)return i.push("...Large Array..."),!0;var f=!1;for(i.push("["),t=0;t<r.length;t++)t>0&&(i.push(","),f&&i.push("\n ")),f=e(r[t]);return i.push("]"),!0}i.push("{");var f=!1;for(t in r)r.hasOwnProperty(t)&&(f&&i.push(",\n"),f=!0,i.push(t),i.push(": \n"),e(r[t]));return i.push("}"),!0}var i=[];return e(r),i.join("")},numeric.parseDate=function(r){function n(r){if("string"==typeof r)return Date.parse(r.replace(/-/g,"/"));if(r instanceof Array){var i,e=[];for(i=0;i<r.length;i++)e[i]=n(r[i]);return e}throw new Error("parseDate: parameter must be arrays of strings")}return n(r)},numeric.parseFloat=function(r){function n(r){if("string"==typeof r)return parseFloat(r);if(r instanceof Array){var i,e=[];for(i=0;i<r.length;i++)e[i]=n(r[i]);return e}throw new Error("parseFloat: parameter must be arrays of strings")}return n(r)},numeric.parseCSV=function(r){var e,i,n=r.split("\n"),t=[],u=/(([^'",]*)|('[^']*')|("[^"]*")),/g,o=/^\s*(([+-]?[0-9]+(\.[0-9]*)?(e[+-]?[0-9]+)?)|([+-]?[0-9]*(\.[0-9]+)?(e[+-]?[0-9]+)?))\s*$/,c=function(r){return r.substr(0,r.length-1)},a=0;for(i=0;i<n.length;i++){var m,f=(n[i]+",").match(u);if(f.length>0){for(t[a]=[],e=0;e<f.length;e++)m=c(f[e]),t[a][e]=o.test(m)?parseFloat(m):m;a++}}return t},numeric.toCSV=function(r){var e,i,t,u,o,c,n=numeric.dim(r);for(t=n[0],u=n[1],c=[],e=0;t>e;e++){for(o=[],i=0;t>i;i++)o[i]=r[e][i].toString();c[e]=o.join(", ")}return c.join("\n")+"\n"},numeric.getURL=function(r){var n=new XMLHttpRequest;return n.open("GET",r,!1),n.send(),n},numeric.imageURL=function(r){function n(r){var e,i,t,u,o,c,a,f,n=r.length,m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",s="";for(e=0;n>e;e+=3)i=r[e],t=r[e+1],u=r[e+2],o=i>>2,c=((3&i)<<4)+(t>>4),a=((15&t)<<2)+(u>>6),f=63&u,e+1>=n?a=f=64:e+2>=n&&(f=64),s+=m.charAt(o)+m.charAt(c)+m.charAt(a)+m.charAt(f);return s}function e(r,n,e){"undefined"==typeof n&&(n=0),"undefined"==typeof e&&(e=r.length);{var c,i=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],t=-1,u=0;r.length}for(c=n;e>c;c++)u=255&(t^r[c]),t=t>>>8^i[u];return-1^t}var u,o,a,f,m,s,h,l,p,y,i=r[0].length,t=r[0][0].length,g=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,t>>24&255,t>>16&255,t>>8&255,255&t,i>>24&255,i>>16&255,i>>8&255,255&i,8,2,0,0,0,-1,-2,-3,-4,-5,-6,-7,-8,73,68,65,84,8,29];for(y=e(g,12,29),g[29]=y>>24&255,g[30]=y>>16&255,g[31]=y>>8&255,g[32]=255&y,u=1,o=0,h=0;i>h;h++){for(g.push(i-1>h?0:1),m=3*t+1+(0===h)&255,s=3*t+1+(0===h)>>8&255,g.push(m),g.push(s),g.push(255&~m),g.push(255&~s),0===h&&g.push(0),l=0;t>l;l++)for(a=0;3>a;a++)m=r[a][h][l],m=m>255?255:0>m?0:Math.round(m),u=(u+m)%65521,o=(o+u)%65521,g.push(m);g.push(0)}return p=(o<<16)+u,g.push(p>>24&255),g.push(p>>16&255),g.push(p>>8&255),g.push(255&p),f=g.length-41,g[33]=f>>24&255,g[34]=f>>16&255,g[35]=f>>8&255,g[36]=255&f,y=e(g,37),g.push(y>>24&255),g.push(y>>16&255),g.push(y>>8&255),g.push(255&y),g.push(0),g.push(0),g.push(0),g.push(0),g.push(73),g.push(69),g.push(78),g.push(68),g.push(174),g.push(66),g.push(96),g.push(130),"data:image/png;base64,"+n(g)},numeric._dim=function(r){for(var n=[];"object"==typeof r;)n.push(r.length),r=r[0];return n},numeric.dim=function(r){var n,e;return"object"==typeof r?(n=r[0],"object"==typeof n?(e=n[0],"object"==typeof e?numeric._dim(r):[r.length,n.length]):[r.length]):[]},numeric.mapreduce=function(r,n){return Function("x","accum","_s","_k",'if(typeof accum === "undefined") accum = '+n+';\nif(typeof x === "number") { var xi = x; '+r+'; return accum; }\nif(typeof _s === "undefined") _s = numeric.dim(x);\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i,xi;\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) {\n        accum = arguments.callee(x[i],accum,_s,_k+1);\n    }    return accum;\n}\nfor(i=_n-1;i>=1;i-=2) { \n    xi = x[i];\n    '+r+";\n    xi = x[i-1];\n    "+r+";\n}\nif(i === 0) {\n    xi = x[i];\n    "+r+"\n}\nreturn accum;")},numeric.mapreduce2=function(r,n){return Function("x","var n = x.length;\nvar i,xi;\n"+n+";\nfor(i=n-1;i!==-1;--i) { \n    xi = x[i];\n    "+r+";\n}\nreturn accum;")},numeric.same=function r(n,e){var i,t;if(n instanceof Array&&e instanceof Array){if(t=n.length,t!==e.length)return!1;for(i=0;t>i;i++)if(n[i]!==e[i]){if("object"!=typeof n[i])return!1;if(!r(n[i],e[i]))return!1}return!0}return!1},numeric.rep=function(r,n,e){"undefined"==typeof e&&(e=0);var u,i=r[e],t=Array(i);if(e===r.length-1){for(u=i-2;u>=0;u-=2)t[u+1]=n,t[u]=n;return-1===u&&(t[0]=n),t}for(u=i-1;u>=0;u--)t[u]=numeric.rep(r,n,e+1);return t},numeric.dotMMsmall=function(r,n){var e,i,t,u,o,c,a,f,m,s,h;for(u=r.length,o=n.length,c=n[0].length,a=Array(u),e=u-1;e>=0;e--){for(f=Array(c),m=r[e],t=c-1;t>=0;t--){for(s=m[o-1]*n[o-1][t],i=o-2;i>=1;i-=2)h=i-1,s+=m[i]*n[i][t]+m[h]*n[h][t];0===i&&(s+=m[0]*n[0][t]),f[t]=s}a[e]=f}return a},numeric._getCol=function(r,n,e){var t,i=r.length;for(t=i-1;t>0;--t)e[t]=r[t][n],--t,e[t]=r[t][n];0===t&&(e[0]=r[0][n])},numeric.dotMMbig=function(r,n){var a,m,s,l,e=numeric._getCol,i=n.length,t=Array(i),u=r.length,o=n[0].length,c=new Array(u),f=numeric.dotVV;for(--i,--u,m=u;-1!==m;--m)c[m]=Array(o);for(--o,m=o;-1!==m;--m)for(e(n,m,t),s=u;-1!==s;--s)l=0,a=r[s],c[s][m]=f(a,t);return c},numeric.dotMV=function(r,n){var t,e=r.length,u=(n.length,Array(e)),o=numeric.dotVV;for(t=e-1;t>=0;t--)u[t]=o(r[t],n);return u},numeric.dotVM=function(r,n){var i,t,u,o,a,s,h;for(u=r.length,o=n[0].length,a=Array(o),t=o-1;t>=0;t--){for(s=r[u-1]*n[u-1][t],i=u-2;i>=1;i-=2)h=i-1,s+=r[i]*n[i][t]+r[h]*n[h][t];0===i&&(s+=r[0]*n[0][t]),a[t]=s}return a},numeric.dotVV=function(r,n){var e,t,i=r.length,u=r[i-1]*n[i-1];for(e=i-2;e>=1;e-=2)t=e-1,u+=r[e]*n[e]+r[t]*n[t];return 0===e&&(u+=r[0]*n[0]),u},numeric.dot=function(r,n){var e=numeric.dim;switch(1e3*e(r).length+e(n).length){case 2002:return n.length<10?numeric.dotMMsmall(r,n):numeric.dotMMbig(r,n);case 2001:return numeric.dotMV(r,n);case 1002:return numeric.dotVM(r,n);case 1001:return numeric.dotVV(r,n);case 1e3:return numeric.mulVS(r,n);case 1:return numeric.mulSV(r,n);case 0:return r*n;default:throw new Error("numeric.dot only works on vectors and matrices")}},numeric.diag=function(r){var n,e,i,o,t=r.length,u=Array(t);for(n=t-1;n>=0;n--){for(o=Array(t),e=n+2,i=t-1;i>=e;i-=2)o[i]=0,o[i-1]=0;for(i>n&&(o[i]=0),o[n]=r[n],i=n-1;i>=1;i-=2)o[i]=0,o[i-1]=0;0===i&&(o[0]=0),u[n]=o}return u},numeric.getDiag=function(r){var e,n=Math.min(r.length,r[0].length),i=Array(n);for(e=n-1;e>=1;--e)i[e]=r[e][e],--e,i[e]=r[e][e];return 0===e&&(i[0]=r[0][0]),i},numeric.identity=function(r){return numeric.diag(numeric.rep([r],1))},numeric.pointwise=function(r,n,e){"undefined"==typeof e&&(e="");var t,o,i=[],u=/\[i\]$/,c="",a=!1;for(t=0;t<r.length;t++)u.test(r[t])?(o=r[t].substring(0,r[t].length-3),c=o):o=r[t],"ret"===o&&(a=!0),i.push(o);return i[r.length]="_s",i[r.length+1]="_k",i[r.length+2]='if(typeof _s === "undefined") _s = numeric.dim('+c+');\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i'+(a?"":", ret = Array(_n)")+";\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee("+r.join(",")+",_s,_k+1);\n    return ret;\n}\n"+e+"\nfor(i=_n-1;i!==-1;--i) {\n    "+n+"\n}\nreturn ret;",Function.apply(null,i)},numeric.pointwise2=function(r,n,e){"undefined"==typeof e&&(e="");var t,o,i=[],u=/\[i\]$/,c="",a=!1;for(t=0;t<r.length;t++)u.test(r[t])?(o=r[t].substring(0,r[t].length-3),c=o):o=r[t],"ret"===o&&(a=!0),i.push(o);return i[r.length]="var _n = "+c+".length;\nvar i"+(a?"":", ret = Array(_n)")+";\n"+e+"\nfor(i=_n-1;i!==-1;--i) {\n"+n+"\n}\nreturn ret;",Function.apply(null,i)},numeric._biforeach=function n(r,e,i,t,u){if(t===i.length-1)return void u(r,e);var o,c=i[t];for(o=c-1;o>=0;o--)n("object"==typeof r?r[o]:r,"object"==typeof e?e[o]:e,i,t+1,u)},numeric._biforeach2=function e(r,n,i,t,u){if(t===i.length-1)return u(r,n);var o,c=i[t],a=Array(c);for(o=c-1;o>=0;--o)a[o]=e("object"==typeof r?r[o]:r,"object"==typeof n?n[o]:n,i,t+1,u);return a},numeric._foreach=function i(r,n,e,t){if(e===n.length-1)return void t(r);var u,o=n[e];for(u=o-1;u>=0;u--)i(r[u],n,e+1,t)},numeric._foreach2=function t(r,n,e,i){if(e===n.length-1)return i(r);var u,o=n[e],c=Array(o);for(u=o-1;u>=0;u--)c[u]=t(r[u],n,e+1,i);return c},numeric.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"},numeric.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",bandeq:"&=",boreq:"|=",bxoreq:"^="},numeric.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","isNaN","isFinite"],numeric.mathfuns2=["atan2","pow","max","min"],numeric.ops1={neg:"-",not:"!",bnot:"~",clone:""},numeric.mapreducers={any:["if(xi) return true;","var accum = false;"],all:["if(!xi) return false;","var accum = true;"],sum:["accum += xi;","var accum = 0;"],prod:["accum *= xi;","var accum = 1;"],norm2Squared:["accum += xi*xi;","var accum = 0;"],norminf:["accum = max(accum,abs(xi));","var accum = 0, max = Math.max, abs = Math.abs;"],norm1:["accum += abs(xi)","var accum = 0, abs = Math.abs;"],sup:["accum = max(accum,xi);","var accum = -Infinity, max = Math.max;"],inf:["accum = min(accum,xi);","var accum = Infinity, min = Math.min;"]},function(){var r,n;for(r=0;r<numeric.mathfuns2.length;++r)n=numeric.mathfuns2[r],numeric.ops2[n]=n;for(r in numeric.ops2)if(numeric.ops2.hasOwnProperty(r)){n=numeric.ops2[r];var e,i,t="";-1!==numeric.myIndexOf.call(numeric.mathfuns2,r)?(t="var "+n+" = Math."+n+";\n",e=function(r,e,i){return r+" = "+n+"("+e+","+i+")"},i=function(r,e){return r+" = "+n+"("+r+","+e+")"}):(e=function(r,e,i){return r+" = "+e+" "+n+" "+i},i=numeric.opseq.hasOwnProperty(r+"eq")?function(r,e){return r+" "+n+"= "+e}:function(r,e){return r+" = "+r+" "+n+" "+e}),numeric[r+"VV"]=numeric.pointwise2(["x[i]","y[i]"],e("ret[i]","x[i]","y[i]"),t),numeric[r+"SV"]=numeric.pointwise2(["x","y[i]"],e("ret[i]","x","y[i]"),t),numeric[r+"VS"]=numeric.pointwise2(["x[i]","y"],e("ret[i]","x[i]","y"),t),numeric[r]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar VV = numeric."+r+"VV, VS = numeric."+r+"VS, SV = numeric."+r+'SV;\nvar dim = numeric.dim;\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof x === "object") {\n      if(typeof y === "object") x = numeric._biforeach2(x,y,dim(x),0,VV);\n      else x = numeric._biforeach2(x,y,dim(x),0,VS);\n  } else if(typeof y === "object") x = numeric._biforeach2(x,y,dim(y),0,SV);\n  else '+i("x","y")+"\n}\nreturn x;\n"),numeric[n]=numeric[r],numeric[r+"eqV"]=numeric.pointwise2(["ret[i]","x[i]"],i("ret[i]","x[i]"),t),numeric[r+"eqS"]=numeric.pointwise2(["ret[i]","x"],i("ret[i]","x"),t),numeric[r+"eq"]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar V = numeric."+r+"eqV, S = numeric."+r+'eqS\nvar s = numeric.dim(x);\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof y === "object") numeric._biforeach(x,y,s,0,V);\n  else numeric._biforeach(x,y,s,0,S);\n}\nreturn x;\n')}for(r=0;r<numeric.mathfuns2.length;++r)n=numeric.mathfuns2[r],delete numeric.ops2[n];for(r=0;r<numeric.mathfuns.length;++r)n=numeric.mathfuns[r],numeric.ops1[n]=n;for(r in numeric.ops1)numeric.ops1.hasOwnProperty(r)&&(t="",n=numeric.ops1[r],-1!==numeric.myIndexOf.call(numeric.mathfuns,r)&&Math.hasOwnProperty(n)&&(t="var "+n+" = Math."+n+";\n"),numeric[r+"eqV"]=numeric.pointwise2(["ret[i]"],"ret[i] = "+n+"(ret[i]);",t),numeric[r+"eq"]=Function("x",'if(typeof x !== "object") return '+n+"x\nvar i;\nvar V = numeric."+r+"eqV;\nvar s = numeric.dim(x);\nnumeric._foreach(x,s,0,V);\nreturn x;\n"),numeric[r+"V"]=numeric.pointwise2(["x[i]"],"ret[i] = "+n+"(x[i]);",t),numeric[r]=Function("x",'if(typeof x !== "object") return '+n+"(x)\nvar i;\nvar V = numeric."+r+"V;\nvar s = numeric.dim(x);\nreturn numeric._foreach2(x,s,0,V);\n"));for(r=0;r<numeric.mathfuns.length;++r)n=numeric.mathfuns[r],delete numeric.ops1[n];for(r in numeric.mapreducers)numeric.mapreducers.hasOwnProperty(r)&&(n=numeric.mapreducers[r],numeric[r+"V"]=numeric.mapreduce2(n[0],n[1]),numeric[r]=Function("x","s","k",n[1]+'if(typeof x !== "object") {    xi = x;\n'+n[0]+';\n    return accum;\n}if(typeof s === "undefined") s = numeric.dim(x);\nif(typeof k === "undefined") k = 0;\nif(k === s.length-1) return numeric.'+r+"V(x);\nvar xi;\nvar n = x.length, i;\nfor(i=n-1;i!==-1;--i) {\n   xi = arguments.callee(x[i]);\n"+n[0]+";\n}\nreturn accum;\n"))}(),numeric.truncVV=numeric.pointwise(["x[i]","y[i]"],"ret[i] = round(x[i]/y[i])*y[i];","var round = Math.round;"),numeric.truncVS=numeric.pointwise(["x[i]","y"],"ret[i] = round(x[i]/y)*y;","var round = Math.round;"),numeric.truncSV=numeric.pointwise(["x","y[i]"],"ret[i] = round(x/y[i])*y[i];","var round = Math.round;"),numeric.trunc=function(r,n){return"object"==typeof r?"object"==typeof n?numeric.truncVV(r,n):numeric.truncVS(r,n):"object"==typeof n?numeric.truncSV(r,n):Math.round(r/n)*n},numeric.inv=function(r){var o,c,f,m,s,h,l,r,n=numeric.dim(r),e=Math.abs,i=n[0],t=n[1],u=numeric.clone(r),a=numeric.identity(i);for(h=0;t>h;++h){var p=-1,y=-1;for(s=h;s!==i;++s)l=e(u[s][h]),l>y&&(p=s,y=l);for(c=u[p],u[p]=u[h],u[h]=c,m=a[p],a[p]=a[h],a[h]=m,r=c[h],l=h;l!==t;++l)c[l]/=r;for(l=t-1;-1!==l;--l)m[l]/=r;for(s=i-1;-1!==s;--s)if(s!==h){for(o=u[s],f=a[s],r=o[h],l=h+1;l!==t;++l)o[l]-=c[l]*r;for(l=t-1;l>0;--l)f[l]-=m[l]*r,--l,f[l]-=m[l]*r;0===l&&(f[0]-=m[0]*r)}}return a},numeric.det=function(r){var n=numeric.dim(r);if(2!==n.length||n[0]!==n[1])throw new Error("numeric: det() only works on square matrices");var t,u,o,a,f,m,s,h,e=n[0],i=1,c=numeric.clone(r);for(u=0;e-1>u;u++){for(o=u,t=u+1;e>t;t++)Math.abs(c[t][u])>Math.abs(c[o][u])&&(o=t);for(o!==u&&(s=c[o],c[o]=c[u],c[u]=s,i*=-1),a=c[u],t=u+1;e>t;t++){for(f=c[t],m=f[u]/a[u],o=u+1;e-1>o;o+=2)h=o+1,f[o]-=a[o]*m,f[h]-=a[h]*m;o!==e&&(f[o]-=a[o]*m)}if(0===a[u])return 0;i*=a[u]}return i*c[u][u]},numeric.transpose=function(r){var n,e,o,c,a,i=r.length,t=r[0].length,u=Array(t);for(e=0;t>e;e++)u[e]=Array(i);for(n=i-1;n>=1;n-=2){for(c=r[n],o=r[n-1],e=t-1;e>=1;--e)a=u[e],a[n]=c[e],a[n-1]=o[e],--e,a=u[e],a[n]=c[e],a[n-1]=o[e];0===e&&(a=u[0],a[n]=c[0],a[n-1]=o[0])}if(0===n){for(o=r[0],e=t-1;e>=1;--e)u[e][0]=o[e],--e,u[e][0]=o[e];0===e&&(u[0][0]=o[0])}return u},numeric.negtranspose=function(r){var n,e,o,c,a,i=r.length,t=r[0].length,u=Array(t);for(e=0;t>e;e++)u[e]=Array(i);for(n=i-1;n>=1;n-=2){for(c=r[n],o=r[n-1],e=t-1;e>=1;--e)a=u[e],a[n]=-c[e],a[n-1]=-o[e],--e,a=u[e],a[n]=-c[e],a[n-1]=-o[e];0===e&&(a=u[0],a[n]=-c[0],a[n-1]=-o[0])}if(0===n){for(o=r[0],e=t-1;e>=1;--e)u[e][0]=-o[e],--e,u[e][0]=-o[e];0===e&&(u[0][0]=-o[0])}return u},numeric._random=function u(r,n){var e,o,i=r[n],t=Array(i);if(n===r.length-1){for(o=Math.random,e=i-1;e>=1;e-=2)t[e]=o(),t[e-1]=o();return 0===e&&(t[0]=o()),t}for(e=i-1;e>=0;e--)t[e]=u(r,n+1);return t},numeric.random=function(r){return numeric._random(r,0)},numeric.norm2=function(r){return Math.sqrt(numeric.norm2Squared(r))},numeric.linspace=function(r,n,e){if("undefined"==typeof e&&(e=Math.max(Math.round(n-r)+1,1)),2>e)return 1===e?[r]:[];var i,t=Array(e);for(e--,i=e;i>=0;i--)t[i]=(i*n+(e-i)*r)/e;return t},numeric.getBlock=function(r,n,e){function i(r,u){var o,c=n[u],a=e[u]-c,f=Array(a);if(u===t.length-1){for(o=a;o>=0;o--)f[o]=r[o+c];return f}for(o=a;o>=0;o--)f[o]=i(r[o+c],u+1);return f}var t=numeric.dim(r);return i(r,0)},numeric.setBlock=function(r,n,e,i){function t(r,i,o){var c,a=n[o],f=e[o]-a;if(o===u.length-1)for(c=f;c>=0;c--)r[c+a]=i[c];for(c=f;c>=0;c--)t(r[c+a],i[c],o+1)}var u=numeric.dim(r);return t(r,i,0),r},numeric.getRange=function(r,n,e){var u,o,a,f,i=n.length,t=e.length,c=Array(i);for(u=i-1;-1!==u;--u)for(c[u]=Array(t),a=c[u],f=r[n[u]],o=t-1;-1!==o;--o)a[o]=f[e[o]];return c},numeric.blockMatrix=function(r){var n=numeric.dim(r);if(n.length<4)return numeric.blockMatrix([r]);var t,u,o,c,a,e=n[0],i=n[1];for(t=0,u=0,o=0;e>o;++o)t+=r[o][0].length;for(c=0;i>c;++c)u+=r[0][c][0].length;var f=Array(t);for(o=0;t>o;++o)f[o]=Array(u);var s,h,l,p,y,m=0;for(o=0;e>o;++o){for(s=u,c=i-1;-1!==c;--c)for(a=r[o][c],s-=a[0].length,l=a.length-1;-1!==l;--l)for(y=a[l],h=f[m+l],p=y.length-1;-1!==p;--p)h[s+p]=y[p];m+=r[o][0].length}return f},numeric.tensor=function(r,n){if("number"==typeof r||"number"==typeof n)return numeric.mul(r,n);var e=numeric.dim(r),i=numeric.dim(n);if(1!==e.length||1!==i.length)throw new Error("numeric: tensor product is only defined for vectors");var c,a,f,m,t=e[0],u=i[0],o=Array(t);for(a=t-1;a>=0;a--){for(c=Array(u),m=r[a],f=u-1;f>=3;--f)c[f]=m*n[f],--f,c[f]=m*n[f],--f,c[f]=m*n[f],--f,c[f]=m*n[f];for(;f>=0;)c[f]=m*n[f],--f;o[a]=c}return o},numeric.T=function(r,n){this.x=r,this.y=n},numeric.t=function(r,n){return new numeric.T(r,n)},numeric.Tbinop=function(r,n,e,i,t){numeric.indexOf;if("string"!=typeof t){var o;t="";for(o in numeric)numeric.hasOwnProperty(o)&&(r.indexOf(o)>=0||n.indexOf(o)>=0||e.indexOf(o)>=0||i.indexOf(o)>=0)&&o.length>1&&(t+="var "+o+" = numeric."+o+";\n")}return Function(["y"],"var x = this;\nif(!(y instanceof numeric.T)) { y = new numeric.T(y); }\n"+t+"\nif(x.y) {  if(y.y) {    return new numeric.T("+i+");\n  }\n  return new numeric.T("+e+");\n}\nif(y.y) {\n  return new numeric.T("+n+");\n}\nreturn new numeric.T("+r+");\n")},numeric.T.prototype.add=numeric.Tbinop("add(x.x,y.x)","add(x.x,y.x),y.y","add(x.x,y.x),x.y","add(x.x,y.x),add(x.y,y.y)"),numeric.T.prototype.sub=numeric.Tbinop("sub(x.x,y.x)","sub(x.x,y.x),neg(y.y)","sub(x.x,y.x),x.y","sub(x.x,y.x),sub(x.y,y.y)"),numeric.T.prototype.mul=numeric.Tbinop("mul(x.x,y.x)","mul(x.x,y.x),mul(x.x,y.y)","mul(x.x,y.x),mul(x.y,y.x)","sub(mul(x.x,y.x),mul(x.y,y.y)),add(mul(x.x,y.y),mul(x.y,y.x))"),numeric.T.prototype.reciprocal=function(){var r=numeric.mul,n=numeric.div;if(this.y){var e=numeric.add(r(this.x,this.x),r(this.y,this.y));return new numeric.T(n(this.x,e),n(numeric.neg(this.y),e))}return new T(n(1,this.x))},numeric.T.prototype.div=function o(r){if(r instanceof numeric.T||(r=new numeric.T(r)),r.y)return this.mul(r.reciprocal());var o=numeric.div;return this.y?new numeric.T(o(this.x,r.x),o(this.y,r.x)):new numeric.T(o(this.x,r.x))},numeric.T.prototype.dot=numeric.Tbinop("dot(x.x,y.x)","dot(x.x,y.x),dot(x.x,y.y)","dot(x.x,y.x),dot(x.y,y.x)","sub(dot(x.x,y.x),dot(x.y,y.y)),add(dot(x.x,y.y),dot(x.y,y.x))"),numeric.T.prototype.transpose=function(){var r=numeric.transpose,n=this.x,e=this.y;return e?new numeric.T(r(n),r(e)):new numeric.T(r(n))},numeric.T.prototype.transjugate=function(){var r=numeric.transpose,n=this.x,e=this.y;return e?new numeric.T(r(n),numeric.negtranspose(e)):new numeric.T(r(n))},numeric.Tunop=function(r,n,e){return"string"!=typeof e&&(e=""),Function("var x = this;\n"+e+"\nif(x.y) {  "+n+";\n}\n"+r+";\n")},numeric.T.prototype.exp=numeric.Tunop("return new numeric.T(ex)","return new numeric.T(mul(cos(x.y),ex),mul(sin(x.y),ex))","var ex = numeric.exp(x.x), cos = numeric.cos, sin = numeric.sin, mul = numeric.mul;"),numeric.T.prototype.conj=numeric.Tunop("return new numeric.T(x.x);","return new numeric.T(x.x,numeric.neg(x.y));"),numeric.T.prototype.neg=numeric.Tunop("return new numeric.T(neg(x.x));","return new numeric.T(neg(x.x),neg(x.y));","var neg = numeric.neg;"),numeric.T.prototype.sin=numeric.Tunop("return new numeric.T(numeric.sin(x.x))","return x.exp().sub(x.neg().exp()).div(new numeric.T(0,2));"),numeric.T.prototype.cos=numeric.Tunop("return new numeric.T(numeric.cos(x.x))","return x.exp().add(x.neg().exp()).div(2);"),numeric.T.prototype.abs=numeric.Tunop("return new numeric.T(numeric.abs(x.x));","return new numeric.T(numeric.sqrt(numeric.add(mul(x.x,x.x),mul(x.y,x.y))));","var mul = numeric.mul;"),numeric.T.prototype.log=numeric.Tunop("return new numeric.T(numeric.log(x.x));","var theta = new numeric.T(numeric.atan2(x.y,x.x)), r = x.abs();\nreturn new numeric.T(numeric.log(r.x),theta.x);"),numeric.T.prototype.norm2=numeric.Tunop("return numeric.norm2(x.x);","var f = numeric.norm2Squared;\nreturn Math.sqrt(f(x.x)+f(x.y));"),numeric.T.prototype.inv=function(){var r=this;if("undefined"==typeof r.y)return new numeric.T(numeric.inv(r.x));var e,i,t,f,m,s,h,l,p,y,g,e,i,t,d,v,x,w,b,M,k,n=r.x.length,u=numeric.identity(n),o=numeric.rep([n,n],0),c=numeric.clone(r.x),a=numeric.clone(r.y);for(e=0;n>e;e++){for(x=c[e][e],w=a[e][e],d=x*x+w*w,t=e,i=e+1;n>i;i++)x=c[i][e],w=a[i][e],v=x*x+w*w,v>d&&(t=i,d=v);for(t!==e&&(k=c[e],c[e]=c[t],c[t]=k,k=a[e],a[e]=a[t],a[t]=k,k=u[e],u[e]=u[t],u[t]=k,k=o[e],o[e]=o[t],o[t]=k),f=c[e],m=a[e],l=u[e],p=o[e],x=f[e],w=m[e],i=e+1;n>i;i++)b=f[i],M=m[i],f[i]=(b*x+M*w)/d,m[i]=(M*x-b*w)/d;for(i=0;n>i;i++)b=l[i],M=p[i],l[i]=(b*x+M*w)/d,p[i]=(M*x-b*w)/d;for(i=e+1;n>i;i++){for(s=c[i],h=a[i],y=u[i],g=o[i],x=s[e],w=h[e],t=e+1;n>t;t++)b=f[t],M=m[t],s[t]-=b*x-M*w,h[t]-=M*x+b*w;for(t=0;n>t;t++)b=l[t],M=p[t],y[t]-=b*x-M*w,g[t]-=M*x+b*w}}for(e=n-1;e>0;e--)for(l=u[e],p=o[e],i=e-1;i>=0;i--)for(y=u[i],g=o[i],x=c[i][e],w=a[i][e],t=n-1;t>=0;t--)b=l[t],M=p[t],y[t]-=x*b-w*M,g[t]-=x*M+w*b;return new numeric.T(u,o)},numeric.T.prototype.get=function(r){var t,n=this.x,e=this.y,i=0,u=r.length;if(e){for(;u>i;)t=r[i],n=n[t],e=e[t],i++;return new numeric.T(n,e)}for(;u>i;)t=r[i],n=n[t],i++;return new numeric.T(n)},numeric.T.prototype.set=function(r,n){var u,e=this.x,i=this.y,t=0,o=r.length,c=n.x,a=n.y;if(0===o)return a?this.y=a:i&&(this.y=void 0),this.x=e,this;if(a){for(i||(i=numeric.rep(numeric.dim(e),0),this.y=i);o-1>t;)u=r[t],e=e[u],i=i[u],t++;return u=r[t],e[u]=c,i[u]=a,this}if(i){for(;o-1>t;)u=r[t],e=e[u],i=i[u],t++;return u=r[t],e[u]=c,i[u]=c instanceof Array?numeric.rep(numeric.dim(c),0):0,this}for(;o-1>t;)u=r[t],e=e[u],t++;return u=r[t],e[u]=c,this},numeric.T.prototype.getRows=function(r,n){var i,u,e=n-r+1,t=Array(e),o=this.x,c=this.y;for(i=r;n>=i;i++)t[i-r]=o[i];if(c){for(u=Array(e),i=r;n>=i;i++)u[i-r]=c[i];return new numeric.T(t,u)}return new numeric.T(t)},numeric.T.prototype.setRows=function(r,n,e){var i,t=this.x,u=this.y,o=e.x,c=e.y;for(i=r;n>=i;i++)t[i]=o[i-r];if(c)for(u||(u=numeric.rep(numeric.dim(t),0),this.y=u),i=r;n>=i;i++)u[i]=c[i-r];else if(u)for(i=r;n>=i;i++)u[i]=numeric.rep([o[i-r].length],0);return this},numeric.T.prototype.getRow=function(r){var n=this.x,e=this.y;return e?new numeric.T(n[r],e[r]):new numeric.T(n[r])},numeric.T.prototype.setRow=function(r,n){var e=this.x,i=this.y,t=n.x,u=n.y;return e[r]=t,u?(i||(i=numeric.rep(numeric.dim(e),0),this.y=i),i[r]=u):i&&(i=numeric.rep([t.length],0)),this},numeric.T.prototype.getBlock=function(r,n){var e=this.x,i=this.y,t=numeric.getBlock;return i?new numeric.T(t(e,r,n),t(i,r,n)):new numeric.T(t(e,r,n))},numeric.T.prototype.setBlock=function(r,n,e){e instanceof numeric.T||(e=new numeric.T(e));var i=this.x,t=this.y,u=numeric.setBlock,o=e.x,c=e.y;return c?(t||(this.y=numeric.rep(numeric.dim(this),0),t=this.y),u(i,r,n,o),u(t,r,n,c),this):(u(i,r,n,o),void(t&&u(t,r,n,numeric.rep(numeric.dim(o),0))))},numeric.T.rep=function(r,n){var e=numeric.T;n instanceof e||(n=new e(n));var i=n.x,t=n.y,u=numeric.rep;return t?new e(u(r,i),u(r,t)):new e(u(r,i))},numeric.T.diag=function c(r){r instanceof numeric.T||(r=new numeric.T(r));var n=r.x,e=r.y,c=numeric.diag;return e?new numeric.T(c(n),c(e)):new numeric.T(c(n))},numeric.T.eig=function(){if(this.y)throw new Error("eig: not implemented for complex matrices.");return numeric.eig(this.x)},numeric.T.identity=function(r){return new numeric.T(numeric.identity(r))},numeric.T.prototype.getDiag=function(){var r=numeric,n=this.x,e=this.y;return e?new r.T(r.getDiag(n),r.getDiag(e)):new r.T(r.getDiag(n))},numeric.house=function(r){var n=numeric.clone(r),e=r[0]>=0?1:-1,i=e*numeric.norm2(r);n[0]+=i;var t=numeric.norm2(n);if(0===t)throw new Error("eig: internal error");return numeric.div(n,t)},numeric.toUpperHessenberg=function(r){var n=numeric.dim(r);if(2!==n.length||n[0]!==n[1])throw new Error("numeric: toUpperHessenberg() only works on square matrices");var i,t,u,o,c,f,m,s,h,p,e=n[0],a=numeric.clone(r),l=numeric.identity(e);for(t=0;e-2>t;t++){for(o=Array(e-t-1),i=t+1;e>i;i++)o[i-t-1]=a[i][t];if(numeric.norm2(o)>0){for(c=numeric.house(o),f=numeric.getBlock(a,[t+1,t],[e-1,e-1]),m=numeric.tensor(c,numeric.dot(c,f)),i=t+1;e>i;i++)for(s=a[i],h=m[i-t-1],u=t;e>u;u++)s[u]-=2*h[u-t];for(f=numeric.getBlock(a,[0,t+1],[e-1,e-1]),m=numeric.tensor(numeric.dot(f,c),c),i=0;e>i;i++)for(s=a[i],h=m[i],u=t+1;e>u;u++)s[u]-=2*h[u-t-1];for(f=Array(e-t-1),i=t+1;e>i;i++)f[i-t-1]=l[i];for(m=numeric.tensor(c,numeric.dot(c,f)),i=t+1;e>i;i++)for(p=l[i],h=m[i-t-1],u=0;e>u;u++)p[u]-=2*h[u]}}return{H:a,Q:l}},numeric.epsilon=2.220446049250313e-16,numeric.QRFrancis=function(r,n){"undefined"==typeof n&&(n=1e4),r=numeric.clone(r);var u,o,c,a,f,m,s,h,l,y,g,d,v,x,w,b,M,k,i=(numeric.clone(r),numeric.dim(r)),t=i[0],p=numeric.identity(t);if(3>t)return{Q:p,B:[[0,t-1]]};var A=numeric.epsilon;for(k=0;n>k;k++){for(b=0;t-1>b;b++)if(Math.abs(r[b+1][b])<A*(Math.abs(r[b][b])+Math.abs(r[b+1][b+1]))){var T=numeric.QRFrancis(numeric.getBlock(r,[0,0],[b,b]),n),j=numeric.QRFrancis(numeric.getBlock(r,[b+1,b+1],[t-1,t-1]),n);for(d=Array(b+1),w=0;b>=w;w++)d[w]=p[w];for(v=numeric.dot(T.Q,d),w=0;b>=w;w++)p[w]=v[w];for(d=Array(t-b-1),w=b+1;t>w;w++)d[w-b-1]=p[w];for(v=numeric.dot(j.Q,d),w=b+1;t>w;w++)p[w]=v[w-b-1];return{Q:p,B:T.B.concat(numeric.add(j.B,b+1))}}if(c=r[t-2][t-2],a=r[t-2][t-1],f=r[t-1][t-2],m=r[t-1][t-1],h=c+m,s=c*m-a*f,l=numeric.getBlock(r,[0,0],[2,2]),h*h>=4*s){var S,_;S=.5*(h+Math.sqrt(h*h-4*s)),_=.5*(h-Math.sqrt(h*h-4*s)),l=numeric.add(numeric.sub(numeric.dot(l,l),numeric.mul(l,S+_)),numeric.diag(numeric.rep([3],S*_)))}else l=numeric.add(numeric.sub(numeric.dot(l,l),numeric.mul(l,h)),numeric.diag(numeric.rep([3],s)));for(u=[l[0][0],l[1][0],l[2][0]],o=numeric.house(u),d=[r[0],r[1],r[2]],v=numeric.tensor(o,numeric.dot(o,d)),w=0;3>w;w++)for(g=r[w],x=v[w],M=0;t>M;M++)g[M]-=2*x[M];for(d=numeric.getBlock(r,[0,0],[t-1,2]),v=numeric.tensor(numeric.dot(d,o),o),w=0;t>w;w++)for(g=r[w],x=v[w],M=0;3>M;M++)g[M]-=2*x[M];for(d=[p[0],p[1],p[2]],v=numeric.tensor(o,numeric.dot(o,d)),w=0;3>w;w++)for(y=p[w],x=v[w],M=0;t>M;M++)y[M]-=2*x[M];var V;for(b=0;t-2>b;b++){for(M=b;b+1>=M;M++)if(Math.abs(r[M+1][M])<A*(Math.abs(r[M][M])+Math.abs(r[M+1][M+1]))){var T=numeric.QRFrancis(numeric.getBlock(r,[0,0],[M,M]),n),j=numeric.QRFrancis(numeric.getBlock(r,[M+1,M+1],[t-1,t-1]),n);for(d=Array(M+1),w=0;M>=w;w++)d[w]=p[w];for(v=numeric.dot(T.Q,d),w=0;M>=w;w++)p[w]=v[w];for(d=Array(t-M-1),w=M+1;t>w;w++)d[w-M-1]=p[w];for(v=numeric.dot(j.Q,d),w=M+1;t>w;w++)p[w]=v[w-M-1];return{Q:p,B:T.B.concat(numeric.add(j.B,M+1))}}for(V=Math.min(t-1,b+3),u=Array(V-b),w=b+1;V>=w;w++)u[w-b-1]=r[w][b];for(o=numeric.house(u),d=numeric.getBlock(r,[b+1,b],[V,t-1]),v=numeric.tensor(o,numeric.dot(o,d)),w=b+1;V>=w;w++)for(g=r[w],x=v[w-b-1],M=b;t>M;M++)g[M]-=2*x[M-b];for(d=numeric.getBlock(r,[0,b+1],[t-1,V]),v=numeric.tensor(numeric.dot(d,o),o),w=0;t>w;w++)for(g=r[w],x=v[w],M=b+1;V>=M;M++)g[M]-=2*x[M-b-1];for(d=Array(V-b),w=b+1;V>=w;w++)d[w-b-1]=p[w];for(v=numeric.tensor(o,numeric.dot(o,d)),w=b+1;V>=w;w++)for(y=p[w],x=v[w-b-1],M=0;t>M;M++)y[M]-=2*x[M]}}throw new Error("numeric: eigenvalue iteration does not converge -- increase maxiter?")},numeric.eig=function(r,n){var o,c,h,p,y,g,d,v,x,w,b,M,k,A,T,j,S,e=numeric.toUpperHessenberg(r),i=numeric.QRFrancis(e.H,n),t=numeric.T,u=r.length,f=i.B,m=numeric.dot(i.Q,numeric.dot(e.H,numeric.transpose(i.Q))),s=new t(numeric.dot(i.Q,e.Q)),l=f.length,_=Math.sqrt;for(c=0;l>c;c++)if(o=f[c][0],o!==f[c][1]){if(p=o+1,y=m[o][o],g=m[o][p],d=m[p][o],v=m[p][p],0===g&&0===d)continue;x=-y-v,w=y*v-g*d,b=x*x-4*w,b>=0?(M=0>x?-.5*(x-_(b)):-.5*(x+_(b)),j=(y-M)*(y-M)+g*g,S=d*d+(v-M)*(v-M),j>S?(j=_(j),A=(y-M)/j,T=g/j):(S=_(S),A=d/S,T=(v-M)/S),h=new t([[T,-A],[A,T]]),s.setRows(o,p,h.dot(s.getRows(o,p)))):(M=-.5*x,k=.5*_(-b),j=(y-M)*(y-M)+g*g,S=d*d+(v-M)*(v-M),j>S?(j=_(j+k*k),A=(y-M)/j,T=g/j,M=0,k/=j):(S=_(S+k*k),A=d/S,T=(v-M)/S,M=k/S,k=0),h=new t([[T,-A],[A,T]],[[M,k],[k,-M]]),s.setRows(o,p,h.dot(s.getRows(o,p))))
}var V=s.dot(r).dot(s.transjugate()),u=r.length,q=numeric.T.identity(u);for(p=0;u>p;p++)if(p>0)for(c=p-1;c>=0;c--){var P=V.get([c,c]),N=V.get([p,p]);numeric.neq(P.x,N.x)||numeric.neq(P.y,N.y)?(M=V.getRow(c).getBlock([c],[p-1]),k=q.getRow(p).getBlock([c],[p-1]),q.set([p,c],V.get([c,p]).neg().sub(M.dot(k)).div(P.sub(N)))):q.setRow(p,q.getRow(c))}for(p=0;u>p;p++)M=q.getRow(p),q.setRow(p,M.div(M.norm2()));return q=q.transpose(),q=s.transjugate().dot(q),{lambda:V.getDiag(),E:q}},numeric.ccsSparse=function(r){var e,i,t,u,n=r.length,o=[];for(t=n-1;-1!==t;--t){i=r[t];for(u in i){for(u=parseInt(u);u>=o.length;)o[o.length]=0;0!==i[u]&&o[u]++}}var e=o.length,c=Array(e+1);for(c[0]=0,t=0;e>t;++t)c[t+1]=c[t]+o[t];var a=Array(c[e]),f=Array(c[e]);for(t=n-1;-1!==t;--t){i=r[t];for(u in i)0!==i[u]&&(o[u]--,a[c[u]+o[u]]=t,f[c[u]+o[u]]=i[u])}return[c,a,f]},numeric.ccsFull=function(r){var c,a,f,m,n=r[0],e=r[1],i=r[2],t=numeric.ccsDim(r),u=t[0],o=t[1],h=numeric.rep([u,o],0);for(c=0;o>c;c++)for(f=n[c],m=n[c+1],a=f;m>a;++a)h[e[a]][c]=i[a];return h},numeric.ccsTSolve=function(r,n,e,i,t){function u(r){var n;if(0===e[r]){for(e[r]=1,n=o[r];n<o[r+1];++n)u(c[n]);t[s]=r,++s}}var o=r[0],c=r[1],a=r[2],f=o.length-1,m=Math.max,s=0;"undefined"==typeof i&&(e=numeric.rep([f],0)),"undefined"==typeof i&&(i=numeric.linspace(0,e.length-1)),"undefined"==typeof t&&(t=[]);var h,l,p,y,g,d,w;for(h=i.length-1;-1!==h;--h)u(i[h]);for(t.length=s,h=t.length-1;-1!==h;--h)e[t[h]]=0;for(h=i.length-1;-1!==h;--h)l=i[h],e[l]=n[l];for(h=t.length-1;-1!==h;--h){for(l=t[h],p=o[l],y=m(o[l+1],p),g=p;g!==y;++g)if(c[g]===l){e[l]/=a[g];break}for(w=e[l],g=p;g!==y;++g)d=c[g],d!==l&&(e[d]-=w*a[g])}return e},numeric.ccsDFS=function(r){this.k=Array(r),this.k1=Array(r),this.j=Array(r)},numeric.ccsDFS.prototype.dfs=function(r,n,e,i,t,u){var c,h,l,o=0,a=t.length,f=this.k,m=this.k1,s=this.j;if(0===i[r])for(i[r]=1,s[0]=r,f[0]=h=n[r],m[0]=l=n[r+1];;)if(h>=l){if(t[a]=s[o],0===o)return;++a,--o,h=f[o],l=m[o]}else c=u[e[h]],0===i[c]?(i[c]=1,f[o]=h,++o,s[o]=c,h=n[c],m[o]=l=n[c+1]):++h},numeric.ccsLPSolve=function(r,n,e,i,t,u,o){var y,g,d,v,w,b,M,k,j,c=r[0],a=r[1],f=r[2],h=(c.length-1,n[0]),l=n[1],p=n[2];for(g=h[t],d=h[t+1],i.length=0,y=g;d>y;++y)o.dfs(u[l[y]],c,a,e,i,u);for(y=i.length-1;-1!==y;--y)e[i[y]]=0;for(y=g;y!==d;++y)v=u[l[y]],e[v]=p[y];for(y=i.length-1;-1!==y;--y){for(v=i[y],w=c[v],b=c[v+1],M=w;b>M;++M)if(u[a[M]]===v){e[v]/=f[M];break}for(j=e[v],M=w;b>M;++M)k=u[a[M]],k!==v&&(e[k]-=j*f[M])}return e},numeric.ccsLUP1=function(r,n){var l,p,y,v,x,w,b,e=r[0].length-1,i=[numeric.rep([e+1],0),[],[]],t=[numeric.rep([e+1],0),[],[]],u=i[0],o=i[1],c=i[2],a=t[0],f=t[1],m=t[2],s=numeric.rep([e],0),h=numeric.rep([e],0),k=numeric.ccsLPSolve,T=(Math.max,Math.abs),j=numeric.linspace(0,e-1),S=numeric.linspace(0,e-1),_=new numeric.ccsDFS(e);for("undefined"==typeof n&&(n=1),l=0;e>l;++l){for(k(i,r,s,h,l,S,_),v=-1,x=-1,p=h.length-1;-1!==p;--p)y=h[p],l>=y||(w=T(s[y]),w>v&&(x=y,v=w));for(T(s[l])<n*v&&(p=j[l],v=j[x],j[l]=v,S[v]=l,j[x]=p,S[p]=x,v=s[l],s[l]=s[x],s[x]=v),v=u[l],x=a[l],b=s[l],o[v]=j[l],c[v]=1,++v,p=h.length-1;-1!==p;--p)y=h[p],w=s[y],h[p]=0,s[y]=0,l>=y?(f[x]=y,m[x]=w,++x):(o[v]=j[y],c[v]=w/b,++v);u[l+1]=v,a[l+1]=x}for(p=o.length-1;-1!==p;--p)o[p]=S[o[p]];return{L:i,U:t,P:j,Pinv:S}},numeric.ccsDFS0=function(r){this.k=Array(r),this.k1=Array(r),this.j=Array(r)},numeric.ccsDFS0.prototype.dfs=function(r,n,e,i,t,u){var a,l,p,c=0,f=t.length,m=this.k,s=this.k1,h=this.j;if(0===i[r])for(i[r]=1,h[0]=r,m[0]=l=n[u[r]],s[0]=p=n[u[r]+1];;){if(isNaN(l))throw new Error("Ow!");if(l>=p){if(t[f]=u[h[c]],0===c)return;++f,--c,l=m[c],p=s[c]}else a=e[l],0===i[a]?(i[a]=1,m[c]=l,++c,h[c]=a,a=u[a],l=n[a],s[c]=p=n[a+1]):++l}},numeric.ccsLPSolve0=function(r,n,e,i,t,u,o,c){var g,d,v,x,b,M,k,A,S,a=r[0],f=r[1],m=r[2],l=(a.length-1,n[0]),p=n[1],y=n[2];for(d=l[t],v=l[t+1],i.length=0,g=d;v>g;++g)c.dfs(p[g],a,f,e,i,u,o);for(g=i.length-1;-1!==g;--g)x=i[g],e[o[x]]=0;for(g=d;g!==v;++g)x=p[g],e[x]=y[g];for(g=i.length-1;-1!==g;--g){for(x=i[g],A=o[x],b=a[x],M=a[x+1],k=b;M>k;++k)if(f[k]===A){e[A]/=m[k];break}for(S=e[A],k=b;M>k;++k)e[f[k]]-=S*m[k];e[A]=S}},numeric.ccsLUP0=function(r,n){var l,p,y,v,x,w,b,e=r[0].length-1,i=[numeric.rep([e+1],0),[],[]],t=[numeric.rep([e+1],0),[],[]],u=i[0],o=i[1],c=i[2],a=t[0],f=t[1],m=t[2],s=numeric.rep([e],0),h=numeric.rep([e],0),k=numeric.ccsLPSolve0,T=(Math.max,Math.abs),j=numeric.linspace(0,e-1),S=numeric.linspace(0,e-1),_=new numeric.ccsDFS0(e);for("undefined"==typeof n&&(n=1),l=0;e>l;++l){for(k(i,r,s,h,l,S,j,_),v=-1,x=-1,p=h.length-1;-1!==p;--p)y=h[p],l>=y||(w=T(s[j[y]]),w>v&&(x=y,v=w));for(T(s[j[l]])<n*v&&(p=j[l],v=j[x],j[l]=v,S[v]=l,j[x]=p,S[p]=x),v=u[l],x=a[l],b=s[j[l]],o[v]=j[l],c[v]=1,++v,p=h.length-1;-1!==p;--p)y=h[p],w=s[j[y]],h[p]=0,s[j[y]]=0,l>=y?(f[x]=y,m[x]=w,++x):(o[v]=j[y],c[v]=w/b,++v);u[l+1]=v,a[l+1]=x}for(p=o.length-1;-1!==p;--p)o[p]=S[o[p]];return{L:i,U:t,P:j,Pinv:S}},numeric.ccsLUP=numeric.ccsLUP0,numeric.ccsDim=function(r){return[numeric.sup(r[1])+1,r[0].length-1]},numeric.ccsGetBlock=function(r,n,e){var i=numeric.ccsDim(r),t=i[0],u=i[1];"undefined"==typeof n?n=numeric.linspace(0,t-1):"number"==typeof n&&(n=[n]),"undefined"==typeof e?e=numeric.linspace(0,u-1):"number"==typeof e&&(e=[e]);var o,m,h,l,p,f=n.length,s=e.length,y=numeric.rep([u],0),g=[],d=[],v=[y,g,d],x=r[0],w=r[1],b=r[2],M=numeric.rep([t],0),k=0,A=numeric.rep([t],0);for(m=0;s>m;++m){l=e[m];var T=x[l],j=x[l+1];for(o=T;j>o;++o)h=w[o],A[h]=1,M[h]=b[o];for(o=0;f>o;++o)p=n[o],A[p]&&(g[k]=o,d[k]=M[n[o]],++k);for(o=T;j>o;++o)h=w[o],A[h]=0;y[m+1]=k}return v},numeric.ccsDot=function(r,n){var w,b,M,k,A,T,j,S,_,V,q,e=r[0],i=r[1],t=r[2],u=n[0],o=n[1],c=n[2],a=numeric.ccsDim(r),f=numeric.ccsDim(n),m=a[0],h=(a[1],f[1]),l=numeric.rep([m],0),p=numeric.rep([m],0),y=Array(m),g=numeric.rep([h],0),d=[],v=[],x=[g,d,v];for(M=0;M!==h;++M){for(k=u[M],A=u[M+1],_=0,b=k;A>b;++b)for(V=o[b],q=c[b],T=e[V],j=e[V+1],w=T;j>w;++w)S=i[w],0===p[S]&&(y[_]=S,p[S]=1,_+=1),l[S]=l[S]+t[w]*q;for(k=g[M],A=k+_,g[M+1]=A,b=_-1;-1!==b;--b)q=k+b,w=y[b],d[q]=w,v[q]=l[w],p[w]=0,l[w]=0;g[M+1]=g[M]+_}return x},numeric.ccsLUPSolve=function(r,n){var e=r.L,i=r.U,u=(r.P,n[0]),o=!1;"object"!=typeof u&&(n=[[0,n.length],numeric.linspace(0,n.length-1),n],u=n[0],o=!0);var x,w,b,M,k,A,c=n[1],a=n[2],f=e[0].length-1,m=u.length-1,s=numeric.rep([f],0),h=Array(f),l=numeric.rep([f],0),p=Array(f),y=numeric.rep([m+1],0),g=[],d=[],v=numeric.ccsTSolve,T=0;for(x=0;m>x;++x){for(k=0,b=u[x],M=u[x+1],w=b;M>w;++w)A=r.Pinv[c[w]],p[k]=A,l[A]=a[w],++k;for(p.length=k,v(e,l,s,p,h),w=p.length-1;-1!==w;--w)l[p[w]]=0;if(v(i,s,l,h,p),o)return l;for(w=h.length-1;-1!==w;--w)s[h[w]]=0;for(w=p.length-1;-1!==w;--w)A=p[w],g[T]=A,d[T]=l[A],l[A]=0,++T;y[x+1]=T}return[y,g,d]},numeric.ccsbinop=function(r,n){return"undefined"==typeof n&&(n=""),Function("X","Y","var Xi = X[0], Xj = X[1], Xv = X[2];\nvar Yi = Y[0], Yj = Y[1], Yv = Y[2];\nvar n = Xi.length-1,m = Math.max(numeric.sup(Xj),numeric.sup(Yj))+1;\nvar Zi = numeric.rep([n+1],0), Zj = [], Zv = [];\nvar x = numeric.rep([m],0),y = numeric.rep([m],0);\nvar xk,yk,zk;\nvar i,j,j0,j1,k,p=0;\n"+n+"for(i=0;i<n;++i) {\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Xj[j];\n    x[k] = 1;\n    Zj[p] = k;\n    ++p;\n  }\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Yj[j];\n    y[k] = Yv[j];\n    if(x[k] === 0) {\n      Zj[p] = k;\n      ++p;\n    }\n  }\n  Zi[i+1] = p;\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = Xv[j];\n  j0 = Zi[i]; j1 = Zi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Zj[j];\n    xk = x[k];\n    yk = y[k];\n"+r+"\n    Zv[j] = zk;\n  }\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = 0;\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) y[Yj[j]] = 0;\n}\nreturn [Zi,Zj,Zv];")},function(){var k,A,B,C;for(k in numeric.ops2)A=isFinite(eval("1"+numeric.ops2[k]+"0"))?"[Y[0],Y[1],numeric."+k+"(X,Y[2])]":"NaN",B=isFinite(eval("0"+numeric.ops2[k]+"1"))?"[X[0],X[1],numeric."+k+"(X[2],Y)]":"NaN",C=isFinite(eval("1"+numeric.ops2[k]+"0"))&&isFinite(eval("0"+numeric.ops2[k]+"1"))?"numeric.ccs"+k+"MM(X,Y)":"NaN",numeric["ccs"+k+"MM"]=numeric.ccsbinop("zk = xk "+numeric.ops2[k]+"yk;"),numeric["ccs"+k]=Function("X","Y",'if(typeof X === "number") return '+A+';\nif(typeof Y === "number") return '+B+";\nreturn "+C+";\n")}(),numeric.ccsScatter=function(r){var m,n=r[0],e=r[1],i=r[2],t=numeric.sup(e)+1,u=n.length,o=numeric.rep([t],0),c=Array(u),a=Array(u),f=numeric.rep([t],0);for(m=0;u>m;++m)f[e[m]]++;for(m=0;t>m;++m)o[m+1]=o[m]+f[m];var h,l,s=o.slice(0);for(m=0;u>m;++m)l=e[m],h=s[l],c[h]=n[m],a[h]=i[m],s[l]=s[l]+1;return[o,c,a]},numeric.ccsGather=function(r){var f,m,s,h,l,n=r[0],e=r[1],i=r[2],t=n.length-1,u=e.length,o=Array(u),c=Array(u),a=Array(u);for(l=0,f=0;t>f;++f)for(s=n[f],h=n[f+1],m=s;m!==h;++m)c[l]=f,o[l]=e[m],a[l]=i[m],++l;return[o,c,a]},numeric.sdim=function a(r,n,e){if("undefined"==typeof n&&(n=[]),"object"!=typeof r)return n;"undefined"==typeof e&&(e=0),e in n||(n[e]=0),r.length>n[e]&&(n[e]=r.length);var i;for(i in r)r.hasOwnProperty(i)&&a(r[i],n,e+1);return n},numeric.sclone=function f(r,n,e){"undefined"==typeof n&&(n=0),"undefined"==typeof e&&(e=numeric.sdim(r).length);var i,t=Array(r.length);if(n===e-1){for(i in r)r.hasOwnProperty(i)&&(t[i]=r[i]);return t}for(i in r)r.hasOwnProperty(i)&&(t[i]=f(r[i],n+1,e));return t},numeric.sdiag=function(r){var e,t,n=r.length,i=Array(n);for(e=n-1;e>=1;e-=2)t=e-1,i[e]=[],i[e][e]=r[e],i[t]=[],i[t][t]=r[t];return 0===e&&(i[0]=[],i[0][0]=r[e]),i},numeric.sidentity=function(r){return numeric.sdiag(numeric.rep([r],1))},numeric.stranspose=function(r){{var i,t,u,n=[];r.length}for(i in r)if(r.hasOwnProperty(i)){u=r[i];for(t in u)u.hasOwnProperty(t)&&("object"!=typeof n[t]&&(n[t]=[]),n[t][i]=u[t])}return n},numeric.sLUP=function(){throw new Error("The function numeric.sLUP had a bug in it and has been removed. Please use the new numeric.ccsLUP function instead.")},numeric.sdotMM=function(r,n){var o,c,a,f,m,s,l,e=r.length,t=(n.length,numeric.stranspose(n)),u=t.length,h=Array(e);for(a=e-1;a>=0;a--){for(l=[],o=r[a],m=u-1;m>=0;m--){s=0,c=t[m];for(f in o)o.hasOwnProperty(f)&&f in c&&(s+=o[f]*c[f]);s&&(l[m]=s)}h[a]=l}return h},numeric.sdotMV=function(r,n){var i,t,u,c,e=r.length,o=Array(e);for(t=e-1;t>=0;t--){i=r[t],c=0;for(u in i)i.hasOwnProperty(u)&&n[u]&&(c+=i[u]*n[u]);c&&(o[t]=c)}return o},numeric.sdotVM=function(r,n){var e,i,t,u,o=[];for(e in r)if(r.hasOwnProperty(e)){t=n[e],u=r[e];for(i in t)t.hasOwnProperty(i)&&(o[i]||(o[i]=0),o[i]+=u*t[i])}return o},numeric.sdotVV=function(r,n){var e,i=0;for(e in r)r[e]&&n[e]&&(i+=r[e]*n[e]);return i},numeric.sdot=function(r,n){var e=numeric.sdim(r).length,i=numeric.sdim(n).length,t=1e3*e+i;switch(t){case 0:return r*n;case 1001:return numeric.sdotVV(r,n);case 2001:return numeric.sdotMV(r,n);case 1002:return numeric.sdotVM(r,n);case 2002:return numeric.sdotMM(r,n);default:throw new Error("numeric.sdot not implemented for tensors of order "+e+" and "+i)}},numeric.sscatter=function(r){var e,i,t,c,n=r[0].length,u=r.length,o=[];for(i=n-1;i>=0;--i)if(r[u-1][i]){for(c=o,t=0;u-2>t;t++)e=r[t][i],c[e]||(c[e]=[]),c=c[e];c[r[t][i]]=r[t+1][i]}return o},numeric.sgather=function m(r,n,e){"undefined"==typeof n&&(n=[]),"undefined"==typeof e&&(e=[]);var i,t,u;i=e.length;for(t in r)if(r.hasOwnProperty(t))if(e[i]=parseInt(t),u=r[t],"number"==typeof u){if(u){if(0===n.length)for(t=i+1;t>=0;--t)n[t]=[];for(t=i;t>=0;--t)n[t].push(e[t]);n[i+1].push(u)}}else m(u,n,e);return e.length>i&&e.pop(),n},numeric.cLU=function(r){var o,c,a,f,m,s,n=r[0],e=r[1],i=r[2],t=n.length,u=0;for(o=0;t>o;o++)n[o]>u&&(u=n[o]);u++;var g,d,v,h=Array(u),l=Array(u),p=numeric.rep([u],1/0),y=numeric.rep([u],-1/0);for(a=0;t>a;a++)o=n[a],c=e[a],c<p[o]&&(p[o]=c),c>y[o]&&(y[o]=c);for(o=0;u-1>o;o++)y[o]>y[o+1]&&(y[o+1]=y[o]);for(o=u-1;o>=1;o--)p[o]<p[o-1]&&(p[o-1]=p[o]);var x=0,w=0;for(o=0;u>o;o++)l[o]=numeric.rep([y[o]-p[o]+1],0),h[o]=numeric.rep([o-p[o]],0),x+=o-p[o]+1,w+=y[o]-o+1;for(a=0;t>a;a++)o=n[a],l[o][e[a]-p[o]]=i[a];for(o=0;u-1>o;o++)for(f=o-p[o],g=l[o],c=o+1;p[c]<=o&&u>c;c++)if(m=o-p[c],s=y[o]-o,d=l[c],v=d[m]/g[f],v){for(a=1;s>=a;a++)d[a+m]-=v*g[a+f];h[c][o-p[c]]=v}var t,T,j,g=[],d=[],b=[],M=[],k=[],A=[];for(t=0,T=0,o=0;u>o;o++){for(f=p[o],m=y[o],j=l[o],c=o;m>=c;c++)j[c-f]&&(g[t]=o,d[t]=c,b[t]=j[c-f],t++);for(j=h[o],c=f;o>c;c++)j[c-f]&&(M[T]=o,k[T]=c,A[T]=j[c-f],T++);M[T]=o,k[T]=o,A[T]=1,T++}return{U:[g,d,b],L:[M,k,A]}},numeric.cLUsolve=function(r,n){var p,g,e=r.L,i=r.U,t=numeric.clone(n),u=e[0],o=e[1],c=e[2],a=i[0],f=i[1],m=i[2],s=a.length,l=(u.length,t.length);for(g=0,p=0;l>p;p++){for(;o[g]<p;)t[p]-=c[g]*t[o[g]],g++;g++}for(g=s-1,p=l-1;p>=0;p--){for(;f[g]>p;)t[p]-=m[g]*t[f[g]],g--;t[p]/=m[g],g--}return t},numeric.cgrid=function(r,n){"number"==typeof r&&(r=[r,r]);var i,t,u,e=numeric.rep(r,-1);if("function"!=typeof n)switch(n){case"L":n=function(n,e){return n>=r[0]/2||e<r[1]/2};break;default:n=function(){return!0}}for(u=0,i=1;i<r[0]-1;i++)for(t=1;t<r[1]-1;t++)n(i,t)&&(e[i][t]=u,u++);return e},numeric.cdelsq=function(r){var u,o,c,a,f,n=[[-1,0],[0,-1],[0,1],[1,0]],e=numeric.dim(r),i=e[0],t=e[1],m=[],s=[],h=[];for(u=1;i-1>u;u++)for(o=1;t-1>o;o++)if(!(r[u][o]<0)){for(c=0;4>c;c++)a=u+n[c][0],f=o+n[c][1],r[a][f]<0||(m.push(r[u][o]),s.push(r[a][f]),h.push(-1));m.push(r[u][o]),s.push(r[u][o]),h.push(4)}return[m,s,h]},numeric.cdotMV=function(r,n){var e,o,a,i=r[0],t=r[1],u=r[2],c=i.length;for(a=0,o=0;c>o;o++)i[o]>a&&(a=i[o]);for(a++,e=numeric.rep([a],0),o=0;c>o;o++)e[i[o]]+=u[o]*n[t[o]];return e},numeric.Spline=function(r,n,e,i,t){this.x=r,this.yl=n,this.yr=e,this.kl=i,this.kr=t},numeric.Spline.prototype._at=function(r,n){var r,c,a,f,e=this.x,i=this.yl,t=this.yr,u=this.kl,o=this.kr,m=numeric.add,s=numeric.sub,h=numeric.mul;c=s(h(u[n],e[n+1]-e[n]),s(t[n+1],i[n])),a=m(h(o[n+1],e[n]-e[n+1]),s(t[n+1],i[n])),f=(r-e[n])/(e[n+1]-e[n]);var l=f*(1-f);return m(m(m(h(1-f,i[n]),h(f,t[n+1])),h(c,l*(1-f))),h(a,l*f))},numeric.Spline.prototype.at=function(r){if("number"==typeof r){var i,t,u,n=this.x,e=n.length,o=Math.floor;for(i=0,t=e-1;t-i>1;)u=o((i+t)/2),n[u]<=r?i=u:t=u;return this._at(r,i)}var m,e=r.length,s=Array(e);for(m=e-1;-1!==m;--m)s[m]=this.at(r[m]);return s},numeric.Spline.prototype.diff=function(){var o,c,a,r=this.x,n=this.yl,e=this.yr,i=this.kl,t=this.kr,u=n.length,f=i,m=t,s=Array(u),h=Array(u),l=numeric.add,p=numeric.mul,y=numeric.div,g=numeric.sub;for(o=u-1;-1!==o;--o)c=r[o+1]-r[o],a=g(e[o+1],n[o]),s[o]=y(l(p(a,6),p(i[o],-4*c),p(t[o+1],-2*c)),c*c),h[o+1]=y(l(p(a,-6),p(i[o],2*c),p(t[o+1],4*c)),c*c);return new numeric.Spline(r,f,m,s,h)},numeric.Spline.prototype.roots=function(){function r(r){return r*r}var e=[],i=this.x,t=this.yl,u=this.yr,o=this.kl,c=this.kr;"number"==typeof t[0]&&(t=[t],u=[u],o=[o],c=[c]);var m,s,h,g,d,v,x,w,b,M,k,A,T,j,S,_,V,q,P,N,F,L,C,O,a=t.length,f=i.length-1,e=Array(a),U=Math.sqrt;for(m=0;m!==a;++m){for(g=t[m],d=u[m],v=o[m],x=c[m],w=[],s=0;s!==f;s++){for(s>0&&d[s]*g[s]<0&&w.push(i[s]),_=i[s+1]-i[s],V=i[s],k=g[s],A=d[s+1],b=v[s]/_,M=x[s+1]/_,S=r(b-M+3*(k-A))+12*M*k,T=M+3*k+2*b-3*A,j=3*(M+b+2*(k-A)),0>=S?(P=T/j,q=P>i[s]&&P<i[s+1]?[i[s],P,i[s+1]]:[i[s],i[s+1]]):(P=(T-U(S))/j,N=(T+U(S))/j,q=[i[s]],P>i[s]&&P<i[s+1]&&q.push(P),N>i[s]&&N<i[s+1]&&q.push(N),q.push(i[s+1])),L=q[0],P=this._at(L,s),h=0;h<q.length-1;h++)if(C=q[h+1],N=this._at(C,s),0!==P)if(0===N||P*N>0)L=C,P=N;else{for(var D=0;O=(P*C-N*L)/(P-N),!(L>=O||O>=C);)if(F=this._at(O,s),F*N>0)C=O,N=F,-1===D&&(P*=.5),D=-1;else{if(!(F*P>0))break;L=O,P=F,1===D&&(N*=.5),D=1}w.push(O),L=q[h+1],P=this._at(L,s)}else w.push(L),L=C,P=N;0===N&&w.push(C)}e[m]=w}return"number"==typeof this.yl[0]?e[0]:e},numeric.spline=function(r,n,e,i){var a,t=r.length,u=[],o=[],c=[],f=numeric.sub,m=numeric.mul,s=numeric.add;for(a=t-2;a>=0;a--)o[a]=r[a+1]-r[a],c[a]=f(n[a+1],n[a]);("string"==typeof e||"string"==typeof i)&&(e=i="periodic");var h=[[],[],[]];switch(typeof e){case"undefined":u[0]=m(3/(o[0]*o[0]),c[0]),h[0].push(0,0),h[1].push(0,1),h[2].push(2/o[0],1/o[0]);break;case"string":u[0]=s(m(3/(o[t-2]*o[t-2]),c[t-2]),m(3/(o[0]*o[0]),c[0])),h[0].push(0,0,0),h[1].push(t-2,0,1),h[2].push(1/o[t-2],2/o[t-2]+2/o[0],1/o[0]);break;default:u[0]=e,h[0].push(0),h[1].push(0),h[2].push(1)}for(a=1;t-1>a;a++)u[a]=s(m(3/(o[a-1]*o[a-1]),c[a-1]),m(3/(o[a]*o[a]),c[a])),h[0].push(a,a,a),h[1].push(a-1,a,a+1),h[2].push(1/o[a-1],2/o[a-1]+2/o[a],1/o[a]);switch(typeof i){case"undefined":u[t-1]=m(3/(o[t-2]*o[t-2]),c[t-2]),h[0].push(t-1,t-1),h[1].push(t-2,t-1),h[2].push(1/o[t-2],2/o[t-2]);break;case"string":h[1][h[1].length-1]=0;break;default:u[t-1]=i,h[0].push(t-1),h[1].push(t-1),h[2].push(1)}u="number"!=typeof u[0]?numeric.transpose(u):[u];var l=Array(u.length);if("string"==typeof e)for(a=l.length-1;-1!==a;--a)l[a]=numeric.ccsLUPSolve(numeric.ccsLUP(numeric.ccsScatter(h)),u[a]),l[a][t-1]=l[a][0];else for(a=l.length-1;-1!==a;--a)l[a]=numeric.cLUsolve(numeric.cLU(h),u[a]);return l="number"==typeof n[0]?l[0]:numeric.transpose(l),new numeric.Spline(r,n,n,l,l)},numeric.fftpow2=function s(r,n){var e=r.length;if(1!==e){var u,o,i=Math.cos,t=Math.sin,c=Array(e/2),a=Array(e/2),f=Array(e/2),m=Array(e/2);for(o=e/2,u=e-1;-1!==u;--u)--o,f[o]=r[u],m[o]=n[u],--u,c[o]=r[u],a[o]=n[u];s(c,a),s(f,m),o=e/2;var h,p,y,l=-6.283185307179586/e;for(u=e-1;-1!==u;--u)--o,-1===o&&(o=e/2-1),h=l*u,p=i(h),y=t(h),r[u]=c[o]+p*f[o]-y*m[o],n[u]=a[o]+p*m[o]+y*f[o]}},numeric._ifftpow2=function h(r,n){var e=r.length;if(1!==e){var u,o,i=Math.cos,t=Math.sin,c=Array(e/2),a=Array(e/2),f=Array(e/2),m=Array(e/2);for(o=e/2,u=e-1;-1!==u;--u)--o,f[o]=r[u],m[o]=n[u],--u,c[o]=r[u],a[o]=n[u];h(c,a),h(f,m),o=e/2;var s,p,y,l=6.283185307179586/e;for(u=e-1;-1!==u;--u)--o,-1===o&&(o=e/2-1),s=l*u,p=i(s),y=t(s),r[u]=c[o]+p*f[o]-y*m[o],n[u]=a[o]+p*m[o]+y*f[o]}},numeric.ifftpow2=function(r,n){numeric._ifftpow2(r,n),numeric.diveq(r,r.length),numeric.diveq(n,n.length)},numeric.convpow2=function(r,n,e,i){numeric.fftpow2(r,n),numeric.fftpow2(e,i);var t,o,c,a,f,u=r.length;for(t=u-1;-1!==t;--t)o=r[t],a=n[t],c=e[t],f=i[t],r[t]=o*c-a*f,n[t]=o*f+a*c;numeric.ifftpow2(r,n)},numeric.T.prototype.fft=function(){{var s,l,r=this.x,n=this.y,e=r.length,i=Math.log,t=i(2),u=Math.ceil(i(2*e-1)/t),o=Math.pow(2,u),c=numeric.rep([o],0),a=numeric.rep([o],0),f=Math.cos,m=Math.sin,h=-3.141592653589793/e,p=numeric.rep([o],0),y=numeric.rep([o],0);Math.floor(e/2)}for(s=0;e>s;s++)p[s]=r[s];if("undefined"!=typeof n)for(s=0;e>s;s++)y[s]=n[s];for(c[0]=1,s=1;o/2>=s;s++)l=h*s*s,c[s]=f(l),a[s]=m(l),c[o-s]=f(l),a[o-s]=m(l);var d=new numeric.T(p,y),v=new numeric.T(c,a);return d=d.mul(v),numeric.convpow2(d.x,d.y,numeric.clone(v.x),numeric.neg(v.y)),d=d.mul(v),d.x.length=e,d.y.length=e,d},numeric.T.prototype.ifft=function(){{var s,l,r=this.x,n=this.y,e=r.length,i=Math.log,t=i(2),u=Math.ceil(i(2*e-1)/t),o=Math.pow(2,u),c=numeric.rep([o],0),a=numeric.rep([o],0),f=Math.cos,m=Math.sin,h=3.141592653589793/e,p=numeric.rep([o],0),y=numeric.rep([o],0);Math.floor(e/2)}for(s=0;e>s;s++)p[s]=r[s];if("undefined"!=typeof n)for(s=0;e>s;s++)y[s]=n[s];for(c[0]=1,s=1;o/2>=s;s++)l=h*s*s,c[s]=f(l),a[s]=m(l),c[o-s]=f(l),a[o-s]=m(l);var d=new numeric.T(p,y),v=new numeric.T(c,a);return d=d.mul(v),numeric.convpow2(d.x,d.y,numeric.clone(v.x),numeric.neg(v.y)),d=d.mul(v),d.x.length=e,d.y.length=e,d.div(e)},numeric.gradient=function(r,n){var e=n.length,i=r(n);if(isNaN(i))throw new Error("gradient: f(x) is a NaN!");var u,c,a,h,d,v,x,b,M,k,t=Math.max,o=numeric.clone(n),f=Array(e),t=(numeric.div,numeric.sub,Math.max),p=.001,y=Math.abs,g=Math.min,w=0;for(u=0;e>u;u++)for(var A=t(1e-6*i,1e-8);;){if(++w,w>20)throw new Error("Numerical gradient fails");if(o[u]=n[u]+A,c=r(o),o[u]=n[u]-A,a=r(o),o[u]=n[u],isNaN(c)||isNaN(a))A/=16;else{if(f[u]=(c-a)/(2*A),d=n[u]-A,v=n[u],x=n[u]+A,b=(c-i)/A,M=(i-a)/A,k=t(y(f[u]),y(i),y(c),y(a),y(d),y(v),y(x),1e-8),h=g(t(y(b-f[u]),y(M-f[u]),y(b-M))/k,A/k),!(h>p))break;A/=16}}return f},numeric.uncmin=function(r,n,e,i,t,u,o){var c=numeric.gradient;"undefined"==typeof o&&(o={}),"undefined"==typeof e&&(e=1e-8),"undefined"==typeof i&&(i=function(n){return c(r,n)}),"undefined"==typeof t&&(t=1e3),n=numeric.clone(n);var m,s,a=n.length,f=r(n);if(isNaN(f))throw new Error("uncmin: f(x0) is a NaN!");var h=Math.max,l=numeric.norm2;e=h(e,numeric.epsilon);var p,y,g,q,P,N,F,C,U,D,d=o.Hinv||numeric.identity(a),v=numeric.dot,w=(numeric.inv,numeric.sub),b=numeric.add,M=numeric.tensor,k=numeric.div,A=numeric.mul,T=numeric.all,j=numeric.isFinite,S=numeric.neg,_=0,X="";for(y=i(n);t>_;){if("function"==typeof u&&u(_,n,f,y,d)){X="Callback returned true";break}if(!T(j(y))){X="Gradient has Infinity or NaN";break}if(p=S(v(d,y)),!T(j(p))){X="Search direction has Infinity or NaN";break}if(D=l(p),e>D){X="Newton step smaller than tol";break}for(U=1,s=v(y,p),P=n;t>_&&!(e>U*D)&&(q=A(p,U),P=b(n,q),m=r(P),m-f>=.1*U*s||isNaN(m));)U*=.5,++_;if(e>U*D){X="Line search step size smaller than tol";break}if(_===t){X="maxit reached during line search";break}g=i(P),N=w(g,y),C=v(N,q),F=v(d,N),d=w(b(d,A((C+v(N,F))/(C*C),M(q,q))),k(b(M(F,q),M(q,F)),C)),n=P,f=m,y=g,++_}return{solution:n,f:f,gradient:y,invHessian:d,iterations:_,message:X}},numeric.Dopri=function(r,n,e,i,t,u,o){this.x=r,this.y=n,this.f=e,this.ymid=i,this.iterations=t,this.events=o,this.message=u},numeric.Dopri.prototype._at=function(r,n){function e(r){return r*r}var f,m,s,h,l,p,r,g,b,M,k,i=this,t=i.x,u=i.y,o=i.f,c=i.ymid,d=(t.length,Math.floor,.5),v=numeric.add,x=numeric.mul,w=numeric.sub;return f=t[n],m=t[n+1],h=u[n],l=u[n+1],g=m-f,s=f+d*g,p=c[n],b=w(o[n],x(h,1/(f-s)+2/(f-m))),M=w(o[n+1],x(l,1/(m-s)+2/(m-f))),k=[e(r-m)*(r-s)/e(f-m)/(f-s),e(r-f)*e(r-m)/e(f-s)/e(m-s),e(r-f)*(r-s)/e(m-f)/(m-s),(r-f)*e(r-m)*(r-s)/e(f-m)/(f-s),(r-m)*e(r-f)*(r-s)/e(f-m)/(m-s)],v(v(v(v(x(h,k[0]),x(p,k[1])),x(l,k[2])),x(b,k[3])),x(M,k[4]))},numeric.Dopri.prototype.at=function(r){var n,e,i,t=Math.floor;if("number"!=typeof r){var u=r.length,o=Array(u);for(n=u-1;-1!==n;--n)o[n]=this.at(r[n]);return o}var c=this.x;for(n=0,e=c.length-1;e-n>1;)i=t(.5*(n+e)),c[i]<=r?n=i:e=i;return this._at(r,n)},numeric.dopri=function(r,n,e,i,t,u,o){"undefined"==typeof t&&(t=1e-6),"undefined"==typeof u&&(u=1e3);var m,s,h,l,p,y,S,_,F,L,Y,Q,Z,c=[r],a=[e],f=[i(r,e)],g=[],d=.2,v=[.075,.225],x=[44/45,-56/15,32/9],w=[19372/6561,-25360/2187,64448/6561,-212/729],b=[9017/3168,-355/33,46732/5247,49/176,-5103/18656],M=[35/384,0,500/1113,125/192,-2187/6784,11/84],k=[.10013431883002395,0,.3918321794184259,-.02982460176594817,.05893268337240795,-.04497888809104361,.023904308236133973],A=[.2,.3,.8,8/9,1,1],T=[-71/57600,0,71/16695,-71/1920,17253/339200,-22/525,.025],j=0,V=(n-r)/10,q=0,P=numeric.add,N=numeric.mul,O=(Math.max,Math.min),U=Math.abs,D=numeric.norminf,B=Math.pow,R=numeric.any,X=numeric.lt,E=numeric.and,H=(numeric.sub,new numeric.Dopri(c,a,f,g,-1,""));for("function"==typeof o&&(Y=o(r,e));n>r&&u>q;)if(++q,r+V>n&&(V=n-r),m=i(r+A[0]*V,P(e,N(d*V,f[j]))),s=i(r+A[1]*V,P(P(e,N(v[0]*V,f[j])),N(v[1]*V,m))),h=i(r+A[2]*V,P(P(P(e,N(x[0]*V,f[j])),N(x[1]*V,m)),N(x[2]*V,s))),l=i(r+A[3]*V,P(P(P(P(e,N(w[0]*V,f[j])),N(w[1]*V,m)),N(w[2]*V,s)),N(w[3]*V,h))),p=i(r+A[4]*V,P(P(P(P(P(e,N(b[0]*V,f[j])),N(b[1]*V,m)),N(b[2]*V,s)),N(b[3]*V,h)),N(b[4]*V,l))),F=P(P(P(P(P(e,N(f[j],V*M[0])),N(s,V*M[2])),N(h,V*M[3])),N(l,V*M[4])),N(p,V*M[5])),y=i(r+V,F),S=P(P(P(P(P(N(f[j],V*T[0]),N(s,V*T[2])),N(h,V*T[3])),N(l,V*T[4])),N(p,V*T[5])),N(y,V*T[6])),L="number"==typeof S?U(S):D(S),L>t){if(V=.2*V*B(t/L,.25),r+V===r){H.msg="Step size became too small";break}}else{if(g[j]=P(P(P(P(P(P(e,N(f[j],V*k[0])),N(s,V*k[2])),N(h,V*k[3])),N(l,V*k[4])),N(p,V*k[5])),N(y,V*k[6])),++j,c[j]=r+V,a[j]=F,f[j]=y,"function"==typeof o){var z,W,G=r,$=r+.5*V;if(Q=o($,g[j-1]),Z=E(X(Y,0),X(0,Q)),R(Z)||(G=$,$=r+V,Y=Q,Q=o($,F),Z=E(X(Y,0),X(0,Q))),R(Z)){for(var rn,nn,en=0,tn=1,un=1;;){if("number"==typeof Y)W=(un*Q*G-tn*Y*$)/(un*Q-tn*Y);else for(W=$,_=Y.length-1;-1!==_;--_)Y[_]<0&&Q[_]>0&&(W=O(W,(un*Q[_]*G-tn*Y[_]*$)/(un*Q[_]-tn*Y[_])));if(G>=W||W>=$)break;z=H._at(W,j-1),nn=o(W,z),rn=E(X(Y,0),X(0,nn)),R(rn)?($=W,Q=nn,Z=rn,un=1,-1===en?tn*=.5:tn=1,en=-1):(G=W,Y=nn,tn=1,1===en?un*=.5:un=1,en=1)}return F=H._at(.5*(r+W),j-1),H.f[j]=i(W,z),H.x[j]=W,H.y[j]=z,H.ymid[j-1]=F,H.events=Z,H.iterations=q,H}}r+=V,e=F,Y=Q,V=O(.8*V*B(t/L,.25),4*V)}return H.iterations=q,H},numeric.LU=function(r,n){n=n||!1;var i,t,u,o,c,a,f,m,s,e=Math.abs,h=r.length,l=h-1,p=new Array(h);for(n||(r=numeric.clone(r)),u=0;h>u;++u){for(f=u,a=r[u],s=e(a[u]),t=u+1;h>t;++t)o=e(r[t][u]),o>s&&(s=o,f=t);for(p[u]=f,f!=u&&(r[u]=r[f],r[f]=a,a=r[u]),c=a[u],i=u+1;h>i;++i)r[i][u]/=c;for(i=u+1;h>i;++i){for(m=r[i],t=u+1;l>t;++t)m[t]-=m[u]*a[t],++t,m[t]-=m[u]*a[t];t===l&&(m[t]-=m[u]*a[t])}}return{LU:r,P:p}},numeric.LUsolve=function(r,n){var e,i,a,f,s,t=r.LU,u=t.length,o=numeric.clone(n),c=r.P;for(e=u-1;-1!==e;--e)o[e]=n[e];for(e=0;u>e;++e)for(a=c[e],c[e]!==e&&(s=o[e],o[e]=o[a],o[a]=s),f=t[e],i=0;e>i;++i)o[e]-=o[i]*f[i];for(e=u-1;e>=0;--e){for(f=t[e],i=e+1;u>i;++i)o[e]-=o[i]*f[i];o[e]/=f[e]}return o},numeric.solve=function(r,n,e){return numeric.LUsolve(numeric.LU(r,e),n)},numeric.echelonize=function(r){var o,c,a,f,m,s,h,l,n=numeric.dim(r),e=n[0],i=n[1],t=numeric.identity(e),u=Array(e),p=Math.abs,y=numeric.diveq;for(r=numeric.clone(r),o=0;e>o;++o){for(a=0,m=r[o],s=t[o],c=1;i>c;++c)p(m[a])<p(m[c])&&(a=c);for(u[o]=a,y(s,m[a]),y(m,m[a]),c=0;e>c;++c)if(c!==o){for(h=r[c],l=h[a],f=i-1;-1!==f;--f)h[f]-=m[f]*l;for(h=t[c],f=e-1;-1!==f;--f)h[f]-=s[f]*l}}return{I:t,A:r,P:u}},numeric.__solveLP=function(r,n,e,i,t,u,o){var g,D,X,I,c=numeric.sum,f=(numeric.log,numeric.mul),m=numeric.sub,s=numeric.dot,h=numeric.div,l=numeric.add,p=r.length,y=e.length,d=!1,x=0,w=1,T=(numeric.transpose(n),numeric.svd,numeric.transpose),S=(numeric.leq,Math.sqrt),_=Math.abs,N=(numeric.muleq,numeric.norminf,numeric.any,Math.min),F=numeric.all,L=numeric.gt,C=Array(p),O=Array(y),B=(numeric.rep([y],1),numeric.solve),R=m(e,s(n,u)),E=s(r,r);for(X=x;t>X;++X){var Y,Z;for(Y=y-1;-1!==Y;--Y)O[Y]=h(n[Y],R[Y]);var H=T(O);for(Y=p-1;-1!==Y;--Y)C[Y]=c(H[Y]);w=.25*_(E/s(r,C));var z=100*S(E/s(C,C));for((!isFinite(w)||w>z)&&(w=z),I=l(r,f(w,C)),D=s(H,O),Y=p-1;-1!==Y;--Y)D[Y][Y]+=1;Z=B(D,h(I,w),!0);var G=h(R,s(n,Z)),$=1;for(Y=y-1;-1!==Y;--Y)G[Y]<0&&($=N($,-.999*G[Y]));if(g=m(u,f(Z,$)),R=m(e,s(n,g)),!F(L(R,0)))return{solution:u,message:"",iterations:X};if(u=g,i>w)return{solution:g,message:"",iterations:X};if(o){var W=s(r,I),J=s(n,I);for(d=!0,Y=y-1;-1!==Y;--Y)if(W*J[Y]<0){d=!1;break}}else d=u[p-1]>=0?!1:!0;if(d)return{solution:g,message:"Unbounded",iterations:X}}return{solution:u,message:"maximum iteration count exceeded",iterations:X}},numeric._solveLP=function(r,n,e,i,t){var c,u=r.length,o=e.length,s=(numeric.sum,numeric.log,numeric.mul,numeric.sub),h=numeric.dot,y=(numeric.div,numeric.add,numeric.rep([u],0).concat([1])),g=numeric.rep([o,1],-1),d=numeric.blockMatrix([[n,g]]),v=e,c=numeric.rep([u],0).concat(Math.max(0,numeric.sup(numeric.neg(e)))+1),x=numeric.__solveLP(y,d,v,i,t,c,!1),w=numeric.clone(x.solution);w.length=u;var b=numeric.inf(s(e,h(n,w)));if(0>b)return{solution:0/0,message:"Infeasible",iterations:x.iterations};var M=numeric.__solveLP(r,n,e,i,t-x.iterations,w,!0);return M.iterations+=x.iterations,M},numeric.solveLP=function(r,n,e,i,t,u,o){if("undefined"==typeof o&&(o=1e3),"undefined"==typeof u&&(u=numeric.epsilon),"undefined"==typeof i)return numeric._solveLP(r,n,e,u,o);var p,c=i.length,a=i[0].length,f=n.length,m=numeric.echelonize(i),s=numeric.rep([a],0),h=m.P,l=[];for(p=h.length-1;-1!==p;--p)s[h[p]]=1;for(p=a-1;-1!==p;--p)0===s[p]&&l.push(p);var y=numeric.getRange,g=numeric.linspace(0,c-1),d=numeric.linspace(0,f-1),v=y(i,g,l),x=y(n,d,h),w=y(n,d,l),b=numeric.dot,M=numeric.sub,k=b(x,m.I),A=M(w,b(k,v)),T=M(e,b(k,t)),j=Array(h.length),S=Array(l.length);for(p=h.length-1;-1!==p;--p)j[p]=r[h[p]];for(p=l.length-1;-1!==p;--p)S[p]=r[l[p]];var _=M(S,b(j,b(m.I,v))),V=numeric._solveLP(_,A,T,u,o),q=V.solution;if(q!==q)return V;var P=b(m.I,M(t,b(v,q))),N=Array(r.length);for(p=h.length-1;-1!==p;--p)N[h[p]]=P[p];for(p=l.length-1;-1!==p;--p)N[l[p]]=q[p];return{solution:N,message:V.message,iterations:V.iterations}},numeric.MPStoLP=function(r){function n(n){throw new Error("MPStoLP: "+n+"\nLine "+u+": "+r[u]+"\nCurrent state: "+i[e]+"\n")}r instanceof String&&r.split("\n");var u,o,c,p,e=0,i=["Initial state","NAME","ROWS","COLUMNS","RHS","BOUNDS","ENDATA"],t=r.length,a=0,f={},m=[],s=0,h={},l=0,y=[],g=[],d=[];for(u=0;t>u;++u){c=r[u];var v=c.match(/\S*/g),x=[];for(o=0;o<v.length;++o)""!==v[o]&&x.push(v[o]);if(0!==x.length){for(o=0;o<i.length&&c.substr(0,i[o].length)!==i[o];++o);if(o<i.length){if(e=o,1===o&&(p=x[1]),6===o)return{name:p,c:y,A:numeric.transpose(g),b:d,rows:f,vars:h}}else switch(e){case 0:case 1:n("Unexpected line");case 2:switch(x[0]){case"N":0===a?a=x[1]:n("Two or more N rows");break;case"L":f[x[1]]=s,m[s]=1,d[s]=0,++s;break;case"G":f[x[1]]=s,m[s]=-1,d[s]=0,++s;break;case"E":f[x[1]]=s,m[s]=0,d[s]=0,++s;break;default:n("Parse error "+numeric.prettyPrint(x))}break;case 3:h.hasOwnProperty(x[0])||(h[x[0]]=l,y[l]=0,g[l]=numeric.rep([s],0),++l);var w=h[x[0]];for(o=1;o<x.length;o+=2)if(x[o]!==a){var b=f[x[o]];g[w][b]=(m[b]<0?-1:1)*parseFloat(x[o+1])}else y[w]=parseFloat(x[o+1]);break;case 4:for(o=1;o<x.length;o+=2)d[f[x[o]]]=(m[f[x[o]]]<0?-1:1)*parseFloat(x[o+1]);break;case 5:break;case 6:n("Internal error")}}}n("Reached end of file without ENDATA")},numeric.seedrandom={pow:Math.pow,random:Math.random},function(r,n,e,i,t,u,o){function c(r){var n,i,t=this,u=r.length,o=0,c=t.i=t.j=t.m=0;for(t.S=[],t.c=[],u||(r=[u++]);e>o;)t.S[o]=o++;for(o=0;e>o;o++)n=t.S[o],c=m(c+n+r[o%u]),i=t.S[c],t.S[o]=i,t.S[c]=n;t.g=function(r){var n=t.S,i=m(t.i+1),u=n[i],o=m(t.j+u),c=n[o];n[i]=c,n[o]=u;for(var a=n[m(u+c)];--r;)i=m(i+1),u=n[i],o=m(o+u),c=n[o],n[i]=c,n[o]=u,a=a*e+n[m(u+c)];return t.i=i,t.j=o,a},t.g(e)}function a(r,n,e,i,t){if(e=[],t=typeof r,n&&"object"==t)for(i in r)if(i.indexOf("S")<5)try{e.push(a(r[i],n-1))}catch(u){}return e.length?e:r+("string"!=t?"\x00":"")}function f(r,n,e,i){for(r+="",e=0,i=0;i<r.length;i++)n[m(i)]=m((e^=19*n[m(i)])+r.charCodeAt(i));r="";for(i in n)r+=String.fromCharCode(n[i]);return r}function m(r){return r&e-1}n.seedrandom=function(m,s){var l,h=[];return m=f(a(s?[m,r]:arguments.length?m:[(new Date).getTime(),r,window],3),h),l=new c(h),f(l.S,r),n.random=function(){for(var r=l.g(i),n=o,c=0;t>r;)r=(r+c)*e,n*=e,c=l.g(1);for(;r>=u;)r/=2,n/=2,c>>>=1;return(r+c)/n},m},o=n.pow(e,i),t=n.pow(2,t),u=2*t,f(n.random(),r)}([],numeric.seedrandom,256,6,52),function(r){function n(r){if("object"!=typeof r)return r;var i,e=[],t=r.length;for(i=0;t>i;i++)e[i+1]=n(r[i]);return e}function e(r){if("object"!=typeof r)return r;var i,n=[],t=r.length;for(i=1;t>i;i++)n[i-1]=e(r[i]);return n}function i(r,n,e){var i,t,u,o,c;for(u=1;e>=u;u+=1){for(r[u][u]=1/r[u][u],c=-r[u][u],i=1;u>i;i+=1)r[i][u]=c*r[i][u];if(o=u+1,o>e)break;for(t=o;e>=t;t+=1)for(c=r[u][t],r[u][t]=0,i=1;u>=i;i+=1)r[i][t]=r[i][t]+c*r[i][u]}}function t(r,n,e,i){var t,u,o,c;for(u=1;e>=u;u+=1){for(c=0,t=1;u>t;t+=1)c+=r[t][u]*i[t];i[u]=(i[u]-c)/r[u][u]}for(o=1;e>=o;o+=1)for(u=e+1-o,i[u]=i[u]/r[u][u],c=-i[u],t=1;u>t;t+=1)i[t]=i[t]+c*r[t][u]}function u(r,n,e,i){var t,u,o,c,a,f;for(u=1;e>=u;u+=1){if(i[1]=u,f=0,o=u-1,1>o){if(f=r[u][u]-f,0>=f)break;r[u][u]=Math.sqrt(f)}else{for(c=1;o>=c;c+=1){for(a=r[c][u],t=1;c>t;t+=1)a-=r[t][u]*r[t][c];a/=r[c][c],r[c][u]=a,f+=a*a}if(f=r[u][u]-f,0>=f)break;r[u][u]=Math.sqrt(f)}i[1]=0}}function o(r,n,e,o,c,a,f,m,s,h,l,p,y,g,d,v){function x(){for(g[1]=g[1]+1,j=F,A=1;h>=A;A+=1){for(j+=1,B=-m[A],T=1;o>=T;T+=1)B+=f[T][A]*c[T];if(Math.abs(B)<H&&(B=0),A>l)d[j]=B;else if(d[j]=-Math.abs(B),B>0){for(T=1;o>=T;T+=1)f[T][A]=-f[T][A];m[A]=-m[A]}}for(A=1;y>=A;A+=1)d[F+p[A]]=0;for(C=0,D=0,A=1;h>=A;A+=1)d[F+A]<D*d[U+A]&&(C=A,D=d[F+A]/d[U+A]);return 0===C?999:0}function w(){for(A=1;o>=A;A+=1){for(B=0,T=1;o>=T;T+=1)B+=r[T][A]*f[T][C];d[A]=B}for(S=q,A=1;o>=A;A+=1)d[S+A]=0;for(T=y+1;o>=T;T+=1)for(A=1;o>=A;A+=1)d[S+A]=d[S+A]+r[A][T]*d[T];for(Q=!0,A=y;A>=1;A-=1){for(B=d[A],j=N+A*(A+3)/2,S=j-A,T=A+1;y>=T;T+=1)B-=d[j]*d[P+T],j+=T;if(B/=d[S],d[P+A]=B,p[A]<l)break;if(0>B)break;Q=!1,V=A}if(!Q)for(R=d[L+V]/d[P+V],A=1;y>=A&&!(p[A]<l)&&!(d[P+A]<0);A+=1)D=d[L+A]/d[P+A],R>D&&(R=D,V=A);
for(B=0,A=q+1;q+o>=A;A+=1)B+=d[A]*d[A];if(Math.abs(B)<=H){if(Q)return v[1]=1,999;for(A=1;y>=A;A+=1)d[L+A]=d[L+A]-R*d[P+A];return d[L+y+1]=d[L+y+1]+R,700}for(B=0,A=1;o>=A;A+=1)B+=d[q+A]*f[A][C];for(X=-d[F+C]/B,Z=!0,Q||X>R&&(X=R,Z=!1),A=1;o>=A;A+=1)c[A]=c[A]+X*d[q+A],Math.abs(c[A])<H&&(c[A]=0);for(a[1]=a[1]+X*B*(X/2+d[L+y+1]),A=1;y>=A;A+=1)d[L+A]=d[L+A]-X*d[P+A];if(d[L+y+1]=d[L+y+1]+X,!Z){for(B=-m[C],T=1;o>=T;T+=1)B+=c[T]*f[T][C];if(C>l)d[F+C]=B;else if(d[F+C]=-Math.abs(B),B>0){for(T=1;o>=T;T+=1)f[T][C]=-f[T][C];m[C]=-m[C]}return 700}for(y+=1,p[y]=C,j=N+(y-1)*y/2+1,A=1;y-1>=A;A+=1)d[j]=d[A],j+=1;if(y===o)d[j]=d[o];else{for(A=o;A>=y+1&&0!==d[A]&&(E=Math.max(Math.abs(d[A-1]),Math.abs(d[A])),I=Math.min(Math.abs(d[A-1]),Math.abs(d[A])),D=d[A-1]>=0?Math.abs(E*Math.sqrt(1+I*I/(E*E))):-Math.abs(E*Math.sqrt(1+I*I/(E*E))),E=d[A-1]/D,I=d[A]/D,1!==E);A-=1)if(0===E)for(d[A-1]=I*D,T=1;o>=T;T+=1)D=r[T][A-1],r[T][A-1]=r[T][A],r[T][A]=D;else for(d[A-1]=D,Y=I/(1+E),T=1;o>=T;T+=1)D=E*r[T][A-1]+I*r[T][A],r[T][A]=Y*(r[T][A-1]+D)-r[T][A],r[T][A-1]=D;d[j]=d[y]}return 0}function b(){if(j=N+V*(V+1)/2+1,S=j+V,0===d[S])return 798;if(E=Math.max(Math.abs(d[S-1]),Math.abs(d[S])),I=Math.min(Math.abs(d[S-1]),Math.abs(d[S])),D=d[S-1]>=0?Math.abs(E*Math.sqrt(1+I*I/(E*E))):-Math.abs(E*Math.sqrt(1+I*I/(E*E))),E=d[S-1]/D,I=d[S]/D,1===E)return 798;if(0===E){for(A=V+1;y>=A;A+=1)D=d[S-1],d[S-1]=d[S],d[S]=D,S+=A;for(A=1;o>=A;A+=1)D=r[A][V],r[A][V]=r[A][V+1],r[A][V+1]=D}else{for(Y=I/(1+E),A=V+1;y>=A;A+=1)D=E*d[S-1]+I*d[S],d[S]=Y*(d[S-1]+D)-d[S],d[S-1]=D,S+=A;for(A=1;o>=A;A+=1)D=E*r[A][V]+I*r[A][V+1],r[A][V+1]=Y*(r[A][V]+D)-r[A][V+1],r[A][V]=D}return 0}function M(){for(S=j-V,A=1;V>=A;A+=1)d[S]=d[j],j+=1,S+=1;return d[L+V]=d[L+V+1],p[V]=p[V+1],V+=1,y>V?797:0}function k(){return d[L+y]=d[L+y+1],d[L+y+1]=0,p[y]=0,y-=1,g[2]=g[2]+1,0}var A,T,j,S,_,V,q,P,N,F,L,C,O,U,D,B,R,X,E,I,Y,Q,Z,H,z,G,$;O=Math.min(o,h),j=2*o+O*(O+5)/2+2*h+1,H=1e-60;do H+=H,z=1+.1*H,G=1+.2*H;while(1>=z||1>=G);for(A=1;o>=A;A+=1)d[A]=n[A];for(A=o+1;j>=A;A+=1)d[A]=0;for(A=1;h>=A;A+=1)p[A]=0;if(_=[],0===v[1]){if(u(r,e,o,_),0!==_[1])return void(v[1]=2);t(r,e,o,n),i(r,e,o)}else{for(T=1;o>=T;T+=1)for(c[T]=0,A=1;T>=A;A+=1)c[T]=c[T]+r[A][T]*n[A];for(T=1;o>=T;T+=1)for(n[T]=0,A=T;o>=A;A+=1)n[T]=n[T]+r[T][A]*c[A]}for(a[1]=0,T=1;o>=T;T+=1)for(c[T]=n[T],a[1]=a[1]+d[T]*c[T],d[T]=0,A=T+1;o>=A;A+=1)r[A][T]=0;for(a[1]=-a[1]/2,v[1]=0,q=o,P=q+o,L=P+O,N=L+O+1,F=N+O*(O+1)/2,U=F+h,A=1;h>=A;A+=1){for(B=0,T=1;o>=T;T+=1)B+=f[T][A]*f[T][A];d[U+A]=Math.sqrt(B)}for(y=0,g[1]=0,g[2]=0,$=0;;){if($=x(),999===$)return;for(;$=w(),0!==$;){if(999===$)return;if(700===$)if(V===y)k();else{for(;b(),$=M(),797===$;);k()}}}}function c(r,i,t,u,c,a){r=n(r),i=n(i),t=n(t);var f,m,s,h,l,x,p=[],y=[],g=[],d=[],v=[];if(c=c||0,a=a?n(a):[void 0,0],u=u?n(u):[],m=r.length-1,s=t[1].length-1,!u)for(f=1;s>=f;f+=1)u[f]=0;for(f=1;s>=f;f+=1)y[f]=0;for(h=0,l=Math.min(m,s),f=1;m>=f;f+=1)g[f]=0;for(p[1]=0,f=1;2*m+l*(l+5)/2+2*s+1>=f;f+=1)d[f]=0;for(f=1;2>=f;f+=1)v[f]=0;return o(r,i,m,m,g,p,t,u,m,s,c,y,h,v,d,a),x="",1===a[1]&&(x="constraints are inconsistent, no solution!"),2===a[1]&&(x="matrix D in quadratic function is not positive definite!"),{solution:e(g),value:e(p),unconstrained_solution:e(i),iterations:e(v),iact:e(y),message:x}}r.solveQP=c}(numeric),numeric.svd=function(r){function n(r,n){return r=Math.abs(r),n=Math.abs(n),r>n?r*Math.sqrt(1+n*n/r/r):0==n?r:n*Math.sqrt(1+r*r/n/n)}var e,i=numeric.epsilon,t=1e-64/i,u=50,o=0,c=0,a=0,f=0,m=0,s=numeric.clone(r),h=s.length,l=s[0].length;if(l>h)throw"Need more rows than columns";var p=new Array(l),y=new Array(l);for(c=0;l>c;c++)p[c]=y[c]=0;var g=numeric.rep([l,l],0),d=0,v=0,x=0,w=0,b=0,M=0,k=0;for(c=0;l>c;c++){for(p[c]=v,k=0,m=c+1,a=c;h>a;a++)k+=s[a][c]*s[a][c];if(t>=k)v=0;else for(d=s[c][c],v=Math.sqrt(k),d>=0&&(v=-v),x=d*v-k,s[c][c]=d-v,a=m;l>a;a++){for(k=0,f=c;h>f;f++)k+=s[f][c]*s[f][a];for(d=k/x,f=c;h>f;f++)s[f][a]+=d*s[f][c]}for(y[c]=v,k=0,a=m;l>a;a++)k+=s[c][a]*s[c][a];if(t>=k)v=0;else{for(d=s[c][c+1],v=Math.sqrt(k),d>=0&&(v=-v),x=d*v-k,s[c][c+1]=d-v,a=m;l>a;a++)p[a]=s[c][a]/x;for(a=m;h>a;a++){for(k=0,f=m;l>f;f++)k+=s[a][f]*s[c][f];for(f=m;l>f;f++)s[a][f]+=k*p[f]}}b=Math.abs(y[c])+Math.abs(p[c]),b>w&&(w=b)}for(c=l-1;-1!=c;c+=-1){if(0!=v){for(x=v*s[c][c+1],a=m;l>a;a++)g[a][c]=s[c][a]/x;for(a=m;l>a;a++){for(k=0,f=m;l>f;f++)k+=s[c][f]*g[f][a];for(f=m;l>f;f++)g[f][a]+=k*g[f][c]}}for(a=m;l>a;a++)g[c][a]=0,g[a][c]=0;g[c][c]=1,v=p[c],m=c}for(c=l-1;-1!=c;c+=-1){for(m=c+1,v=y[c],a=m;l>a;a++)s[c][a]=0;if(0!=v){for(x=s[c][c]*v,a=m;l>a;a++){for(k=0,f=m;h>f;f++)k+=s[f][c]*s[f][a];for(d=k/x,f=c;h>f;f++)s[f][a]+=d*s[f][c]}for(a=c;h>a;a++)s[a][c]=s[a][c]/v}else for(a=c;h>a;a++)s[a][c]=0;s[c][c]+=1}for(i*=w,f=l-1;-1!=f;f+=-1)for(var A=0;u>A;A++){var T=!1;for(m=f;-1!=m;m+=-1){if(Math.abs(p[m])<=i){T=!0;break}if(Math.abs(y[m-1])<=i)break}if(!T){o=0,k=1;var j=m-1;for(c=m;f+1>c&&(d=k*p[c],p[c]=o*p[c],!(Math.abs(d)<=i));c++)for(v=y[c],x=n(d,v),y[c]=x,o=v/x,k=-d/x,a=0;h>a;a++)b=s[a][j],M=s[a][c],s[a][j]=b*o+M*k,s[a][c]=-b*k+M*o}if(M=y[f],m==f){if(0>M)for(y[f]=-M,a=0;l>a;a++)g[a][f]=-g[a][f];break}if(A>=u-1)throw"Error: no convergence.";for(w=y[m],b=y[f-1],v=p[f-1],x=p[f],d=((b-M)*(b+M)+(v-x)*(v+x))/(2*x*b),v=n(d,1),d=0>d?((w-M)*(w+M)+x*(b/(d-v)-x))/w:((w-M)*(w+M)+x*(b/(d+v)-x))/w,o=1,k=1,c=m+1;f+1>c;c++){for(v=p[c],b=y[c],x=k*v,v=o*v,M=n(d,x),p[c-1]=M,o=d/M,k=x/M,d=w*o+v*k,v=-w*k+v*o,x=b*k,b*=o,a=0;l>a;a++)w=g[a][c-1],M=g[a][c],g[a][c-1]=w*o+M*k,g[a][c]=-w*k+M*o;for(M=n(d,x),y[c-1]=M,o=d/M,k=x/M,d=o*v+k*b,w=-k*v+o*b,a=0;h>a;a++)b=s[a][c-1],M=s[a][c],s[a][c-1]=b*o+M*k,s[a][c]=-b*k+M*o}p[m]=0,p[f]=d,y[f]=w}for(c=0;c<y.length;c++)y[c]<i&&(y[c]=0);for(c=0;l>c;c++)for(a=c-1;a>=0;a--)if(y[a]<y[c]){for(o=y[a],y[a]=y[c],y[c]=o,f=0;f<s.length;f++)e=s[f][c],s[f][c]=s[f][a],s[f][a]=e;for(f=0;f<g.length;f++)e=g[f][c],g[f][c]=g[f][a],g[f][a]=e;c=a}return{U:s,S:y,V:g}};